"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,i){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!i||"object"!=typeof i&&"function"!=typeof i?t:i}function _inherits(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function, not "+typeof i);t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i&&(Object.setPrototypeOf?Object.setPrototypeOf(t,i):t.__proto__=i)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,i){for(var e=0;e<i.length;e++){var l=i[e];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,l.key,l)}}return function(i,e,l){return e&&t(i.prototype,e),l&&t(i,l),i}}(),_jqmin=require("jqmin"),_jqmin2=_interopRequireDefault(_jqmin),_AX6UICore2=require("./AX6UICore.js"),_AX6UICore3=_interopRequireDefault(_AX6UICore2),_AX6Util=require("./AX6Util"),_AX6Util2=_interopRequireDefault(_AX6Util),_AX6Info=require("./AX6Info"),_AX6Info2=_interopRequireDefault(_AX6Info),_AX6Mustache=require("./AX6Mustache"),_AX6Mustache2=_interopRequireDefault(_AX6Mustache),_AX6UIGrid_data=require("./AX6UIGrid/AX6UIGrid_data"),_AX6UIGrid_data2=_interopRequireDefault(_AX6UIGrid_data),_AX6UIGrid_header=require("./AX6UIGrid/AX6UIGrid_header"),_AX6UIGrid_header2=_interopRequireDefault(_AX6UIGrid_header),_AX6UIGrid_body=require("./AX6UIGrid/AX6UIGrid_body"),_AX6UIGrid_body2=_interopRequireDefault(_AX6UIGrid_body),_AX6UIGrid_scroller=require("./AX6UIGrid/AX6UIGrid_scroller"),_AX6UIGrid_scroller2=_interopRequireDefault(_AX6UIGrid_scroller),_AX6UIGrid_page=require("./AX6UIGrid/AX6UIGrid_page"),_AX6UIGrid_page2=_interopRequireDefault(_AX6UIGrid_page),_AX6UIGrid_tmpl=require("./AX6UIGrid/AX6UIGrid_tmpl"),_AX6UIGrid_tmpl2=_interopRequireDefault(_AX6UIGrid_tmpl),_AX6UIGrid_util=require("./AX6UIGrid/AX6UIGrid_util"),_AX6UIGrid_util2=_interopRequireDefault(_AX6UIGrid_util),formatter={},collector={},ctrlKeys={33:"KEY_PAGEUP",34:"KEY_PAGEDOWN",35:"KEY_END",36:"KEY_HOME",37:"KEY_LEFT",38:"KEY_UP",39:"KEY_RIGHT",40:"KEY_DOWN"},tmpl={},initGrid=function(){var t={instanceId:this.id};return this.$target.html(_AX6Mustache2.default.render(this.__tmpl.main.call(this),t)),this.$={container:{hidden:this.$target.find('[data-ax6grid-container="hidden"]'),root:this.$target.find('[data-ax6grid-container="root"]'),header:this.$target.find('[data-ax6grid-container="header"]'),body:this.$target.find('[data-ax6grid-container="body"]'),page:this.$target.find('[data-ax6grid-container="page"]'),scroller:this.$target.find('[data-ax6grid-container="scroller"]')},panel:{"aside-header":this.$target.find('[data-ax6grid-panel="aside-header"]'),"left-header":this.$target.find('[data-ax6grid-panel="left-header"]'),header:this.$target.find('[data-ax6grid-panel="header"]'),"header-scroll":this.$target.find('[data-ax6grid-panel-scroll="header"]'),"right-header":this.$target.find('[data-ax6grid-panel="right-header"]'),"top-aside-body":this.$target.find('[data-ax6grid-panel="top-aside-body"]'),"top-left-body":this.$target.find('[data-ax6grid-panel="top-left-body"]'),"top-body":this.$target.find('[data-ax6grid-panel="top-body"]'),"top-body-scroll":this.$target.find('[data-ax6grid-panel-scroll="top-body"]'),"top-right-body":this.$target.find('[data-ax6grid-panel="top-right-body"]'),"aside-body":this.$target.find('[data-ax6grid-panel="aside-body"]'),"aside-body-scroll":this.$target.find('[data-ax6grid-panel-scroll="aside-body"]'),"left-body":this.$target.find('[data-ax6grid-panel="left-body"]'),"left-body-scroll":this.$target.find('[data-ax6grid-panel-scroll="left-body"]'),body:this.$target.find('[data-ax6grid-panel="body"]'),"body-scroll":this.$target.find('[data-ax6grid-panel-scroll="body"]'),"right-body":this.$target.find('[data-ax6grid-panel="right-body"]'),"right-body-scroll":this.$target.find('[data-ax6grid-panel-scroll="right-body"]'),"bottom-aside-body":this.$target.find('[data-ax6grid-panel="bottom-aside-body"]'),"bottom-left-body":this.$target.find('[data-ax6grid-panel="bottom-left-body"]'),"bottom-body":this.$target.find('[data-ax6grid-panel="bottom-body"]'),"bottom-body-scroll":this.$target.find('[data-ax6grid-panel-scroll="bottom-body"]'),"bottom-right-body":this.$target.find('[data-ax6grid-panel="bottom-right-body"]')},livePanelKeys:[],scroller:{vertical:this.$target.find('[data-ax6grid-scroller="vertical"]'),"vertical-bar":this.$target.find('[data-ax6grid-scroller="vertical-bar"]'),horizontal:this.$target.find('[data-ax6grid-scroller="horizontal"]'),"horizontal-bar":this.$target.find('[data-ax6grid-scroller="horizontal-bar"]'),corner:this.$target.find('[data-ax6grid-scroller="corner"]')},page:{navigation:this.$target.find('[data-ax6grid-page="navigation"]'),status:this.$target.find('[data-ax6grid-page="status"]')},form:{clipboard:this.$target.find('[data-ax6grid-form="clipboard"]')},resizer:{vertical:this.$target.find('[data-ax6grid-resizer="vertical"]'),horizontal:this.$target.find('[data-ax6grid-resizer="horizontal"]')}},this.$.container.root.css({height:this.config.height||this.config._height}),this},initColumns=function(t){_AX6Util2.default.isArray(t)||(t=[]),this.columns=_AX6Util2.default.deepCopy(t),this.headerTable=_AX6UIGrid_util2.default.makeHeaderTable.call(this,this.columns),this.xvar.frozenColumnIndex=this.config.frozenColumnIndex||0,this.bodyRowTable=_AX6UIGrid_util2.default.makeBodyRowTable.call(this,this.columns),this.bodyRowMap=_AX6UIGrid_util2.default.makeBodyRowMap.call(this,this.bodyRowTable),this.xvar.bodyTrHeight=this.bodyRowTable.rows.length*this.config.body.columnHeight;for(var i={},e=0,l=this.headerTable.rows.length;e<l;e++)for(var o=this.headerTable.rows[e],a=0,r=o.cols.length;a<r;a++)i[o.cols[a].colIndex]=_jqmin2.default.extend({},o.cols[a]);this.colGroup=[];for(var n in i)this.colGroup.push(i[n]);return this},onResetColumns=function(){initColumns.call(this,this.config.columns),resetColGroupWidth.call(this),this.config.footSum&&(initFootSum.call(this,this.config.footSum),this.needToPaintSum=!0),this.config.body.grouping&&initBodyGroup.call(this,this.config.body.grouping),alignGrid.call(this,!0),_AX6UIGrid_header2.default.repaint.call(this,!0),_AX6UIGrid_body2.default.repaint.call(this,!0),_AX6UIGrid_scroller2.default.resize.call(this)},resetColGroupWidth=function(){var t=this,i=this.$.container.root.width()-function(){var i=0;return t.config.showLineNumber&&(i+=t.config.lineNumberColumnWidth),t.config.showRowSelector&&(i+=t.config.rowSelectorColumnWidth),i+=t.config.scroller.size}(),e=0,l=void 0,o=[],a=this.colGroup,r=void 0,n=void 0;for(r=0,n=a.length;r<n;r++)_AX6Util2.default.isNumber(a[r].width)?e+=a[r]._width=a[r].width:"*"===a[r].width?o.push(r):"%"===_AX6Util2.default.right(a[r].width,1)&&(e+=a[r]._width=i*_AX6Util2.default.left(a[r].width,"%")/100);if(o.length>0)for(l=(i-e)/o.length,r=0,n=o.length;r<n;r++)a[o[r]]._width=l},initFootSum=function(t){_AX6Util2.default.isArray(t)?this.footSumTable=_AX6UIGrid_util2.default.makeFootSumTable.call(this,this.footSumColumns=t):(this.footSumColumns=[],this.footSumTable={})},initBodyGroup=function(t){var i=_jqmin2.default.extend({},t);"by"in i&&"columns"in i?(this.bodyGrouping={by:i.by,columns:i.columns},this.bodyGroupingTable=_AX6UIGrid_util2.default.makeBodyGroupingTable.call(this,this.bodyGrouping.columns),this.sortInfo=function(){for(var t={},i=0,e=this.bodyGrouping.by.length;i<e;i++){t[this.bodyGrouping.by[i]]={orderBy:"asc",seq:i,fixed:!0};for(var l=0,o=this.colGroup.length;l<o;l++)this.colGroup[l].key===this.bodyGrouping.by[i]&&(this.colGroup[l].sort="asc",this.colGroup[l].sortFixed=!0)}return t}.call(this)):this.config.body.grouping=!1},alignGrid=function(t){var i=this;if(Math.min(this.$target.innerWidth(),this.$target.innerHeight())<5)return!1;this.config.height||this.$.container.root.css({height:this.config._height=this.$target.height()});var e=this.$.container.root.width(),l=this.$.container.root.height(),o=e,a=l,r=this.config.asidePanelWidth=function(){var t=0;return i.config.showLineNumber&&(t+=i.config.lineNumberColumnWidth),i.config.showRowSelector&&(t+=i.config.rowSelectorColumnWidth),t}(),n=this.config.frozenPanelWidth=function(t,i){for(var e=0,l=0,o=i;l<o;l++)e+=t[l]._width;return e}(this.colGroup,this.config.frozenColumnIndex),d=void 0,s=void 0,h=void 0,c=this.config.frozenRowIndex*this.xvar.bodyTrHeight,u=this.footSumColumns.length*this.xvar.bodyTrHeight,f=this.config.header.display?this.headerTable.rows.length*this.config.header.columnHeight:0,_=this.config.page.display?this.config.page.height:0;d=l-f-_-u<this.list.length*this.xvar.bodyTrHeight?this.config.scroller.size:0,(s=function(){for(var t=0,l=e-r-d,o=0,a=i.colGroup.length;o<a;o++)t+=i.colGroup[o]._width;return t>l?i.config.scroller.size:0}())>0&&(d=l-f-_-u-s<this.list.length*this.xvar.bodyTrHeight?this.config.scroller.size:0),o=e-d,h=(a=l-_-s)-f;var g=function(t,i,e,l){var a={display:"block"},d=!1;switch(e){case"aside":0===r?d=!0:(a.left=0,a.width=r);break;case"left":0===this.config.frozenColumnIndex?d=!0:(a.left=r,a.width=n);break;case"right":this.config.rightSum||(d=!0);break;default:"page"!==l&&(0===this.config.frozenColumnIndex?a.left=r:a.left=n+r,a.width=o-r-n-0)}if(d)return t.css({display:"none"}),this;if("body"===l)switch(i){case"top":0==this.config.frozenRowIndex?d=!0:(a.top=0,a.height=c);break;case"bottom":this.config.footSum?(a.top=h-u,a.height=u):d=!0;break;default:a.top=c,a.height=h-c-u}else"header"===l?a.height=f:"page"===l&&(0==_?d=!0:a.height=_);return d?(t.css({display:"none"}),this):(t.css(a),this)},y=function(t,i,e,l){var r={display:"block"},n=!1;switch(l){case"vertical":i>0?(r.width=i,r.height=a,r.bottom=e+_):n=!0;break;case"horizontal":e>0?(r.width=o,r.height=e,r.right=i,r.bottom=_):n=!0;break;case"corner":i>0&&e>0?(r.width=i,r.height=e,r.bottom=_):n=!0}if(n)return t.css({display:"none"}),this;t.css(r)};return this.$.container.header.css({height:f}),this.$.container.body.css({height:h}),g.call(this,this.$.panel["aside-header"],"","aside","header"),g.call(this,this.$.panel["left-header"],"","left","header"),g.call(this,this.$.panel.header,"","","header"),g.call(this,this.$.panel["right-header"],"","right","header"),g.call(this,this.$.panel["top-aside-body"],"top","aside","body"),g.call(this,this.$.panel["top-left-body"],"top","left","body"),g.call(this,this.$.panel["top-body"],"top","","body"),g.call(this,this.$.panel["top-right-body"],"top","right","body"),g.call(this,this.$.panel["aside-body"],"","aside","body"),g.call(this,this.$.panel["left-body"],"","left","body"),g.call(this,this.$.panel.body,"","","body"),g.call(this,this.$.panel["right-body"],"","right","body"),g.call(this,this.$.panel["bottom-aside-body"],"bottom","aside","body"),g.call(this,this.$.panel["bottom-left-body"],"bottom","left","body"),g.call(this,this.$.panel["bottom-body"],"bottom","","body"),g.call(this,this.$.panel["bottom-right-body"],"bottom","right","body"),y.call(this,this.$.scroller.vertical,d,s,"vertical"),y.call(this,this.$.scroller.horizontal,d,s,"horizontal"),y.call(this,this.$.scroller.corner,d,s,"corner"),g.call(this,this.$.container.page,"","","page"),this.xvar.bodyHeight=this.$.panel.body.height(),this.xvar.bodyWidth=this.$.panel.body.width(),!0},sortColumns=function(t){if(_AX6UIGrid_header2.default.repaint.call(this),_AX6Util2.default.isFunction(this.config.remoteSort)){var i={sortInfo:[]};for(var e in t)i.sortInfo.push({key:e,orderBy:t[e].orderBy,seq:t[e].seq});i.sortInfo.sort(function(t,i){return t.seq>i.seq}),this.config.remoteSort.call(i,i)}else this.config.body.grouping?this.list=_AX6UIGrid_data2.default.initData.call(this,_AX6UIGrid_data2.default.sort.call(this,t,_AX6UIGrid_data2.default.clearGroupingData.call(this,this.list))):this.list=_AX6UIGrid_data2.default.sort.call(this,t,_AX6UIGrid_data2.default.clearGroupingData.call(this,this.list),{resetLineNumber:!0}),_AX6UIGrid_body2.default.repaint.call(this,!0),_AX6UIGrid_scroller2.default.resize.call(this)},AX6UIGrid=function(t){function i(t){var e;_classCallCheck(this,i);var l=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this));return l.config={theme:"default",animateTime:250,debounceTime:250,appendDebouncer:null,appendDebounceTimes:0,appendProgressIcon:"...",appendProgress:!1,frozenColumnIndex:0,frozenRowIndex:0,showLineNumber:!1,showRowSelector:!1,multipleSelect:!0,virtualScrollY:!0,virtualScrollX:!0,virtualScrollYCountMargin:0,virtualScrollAccelerated:!0,virtualScrollAcceleratedDelayTime:10,height:0,columnMinWidth:100,lineNumberColumnWidth:30,rowSelectorColumnWidth:26,sortable:void 0,remoteSort:!1,header:{display:!0,align:!1,columnHeight:26,columnPadding:3,columnBorderWidth:1},body:{align:!1,columnHeight:26,columnPadding:3,columnBorderWidth:1,grouping:!1,mergeCells:!1},rightSum:!1,footSum:!1,page:{height:25,display:!0,statusDisplay:!0,navigationItemCount:5},scroller:{size:15,barMinSize:15,trackPadding:4},columnKeys:{selected:"__selected__",modified:"__modified__",deleted:"__deleted__",disableSelection:"__disable_selection__"},tree:{use:!1,hashDigit:8,indentWidth:10,arrowWidth:15,iconWidth:18,icons:{openedArrow:"▾",collapsedArrow:"▸",groupIcon:"⊚",collapsedGroupIcon:"⊚",itemIcon:"⊙"},columnKeys:{parentKey:"pid",selfKey:"id",collapse:"collapse",hidden:"hidden",parentHash:"__hp__",selfHash:"__hs__",children:"__children__",depth:"__depth__"}}},_jqmin2.default.extend(!0,l.config,t),l.xvar={bodyTrHeight:0,scrollContentWidth:0,scrollContentHeight:0,scrollTimer:null},l.columns=[],l.colGroup=[],l.footSumColumns=[],l.bodyGrouping={},l.list=[],l.proxyList=null,l.page=null,l.selectedDataIndexs=[],l.deletedList=[],l.sortInfo={},l.focused=!1,l.focusedColumn={},l.selectedColumn={},l.isInlineEditing=!1,l.inlineEditing={},l.listIndexMap={},l.contextMenu=null,l.headerTable={},l.leftHeaderData={},l.headerData={},l.rightHeaderData={},l.bodyRowTable={},l.leftBodyRowData={},l.bodyRowData={},l.rightBodyRowData={},l.bodyRowMap={},l.bodyGroupingTable={},l.leftBodyGroupingData={},l.bodyGroupingData={},l.rightBodyGroupingData={},l.bodyGroupingMap={},l.footSumTable={},l.leftFootSumData={},l.footSumData={},l.needToPaintSum=!0,l.customFormatter=i.getFormatter(),l.customCollector=i.getCollector(),l.__tmpl=Object.assign(_AX6UIGrid_tmpl2.default,i.getTmpl()),void 0!==t&&l.init(),e=l,_possibleConstructorReturn(l,e)}return _inherits(i,_AX6UICore3.default),_createClass(i,null,[{key:"setFormatter",value:function(t){return formatter=Object.assign(formatter,t)}},{key:"getFormatter",value:function(){return formatter||{}}},{key:"setCollector",value:function(t){return collector=Object.assign(collector,t)}},{key:"getCollector",value:function(){return collector||{}}},{key:"setTmpl",value:function(t){return tmpl=Object.assign(tmpl,t)}},{key:"getTmpl",value:function(){return tmpl||{}}}]),_createClass(i,[{key:"init",value:function(){var t=this;this.onStateChanged=this.config.onStateChanged,this.onLoad=this.config.onLoad,this.initOnce(),void 0!==this.config.target&&(this.$target=(0,_jqmin2.default)(this.config.target),function(t){_AX6Util2.default.isObject(t)&&!t.error&&(this.config=_jqmin2.default.extend(!0,{},this.config,t))}.call(this,_AX6Util2.default.parseJson(this.$target.attr("data-ax6ui-grid-config"),!0)),this.config.height||(this.config._height=this.$target.height()),this.id||(this.id=this.$target.data("ax6ui-grid-id")),this.id||(this.id="ax6ui-grid-"+this.instanceId,this.$target.data("ax6ui-grid-id",this.id)),_AX6UIGrid_data2.default.init.call(this),this.config.tree.use&&(this.sortInfo={},this.sortInfo[this.config.tree.columnKeys.selfHash]={orderBy:"asc",seq:0,fixed:!0}),initGrid.call(this),initColumns.call(this,this.config.columns),resetColGroupWidth.call(this),this.config.footSum&&initFootSum.call(this,this.config.footSum),this.config.body.grouping&&initBodyGroup.call(this,this.config.body.grouping),alignGrid.call(this,!0),_AX6UIGrid_header2.default.init.call(this),_AX6UIGrid_header2.default.repaint.call(this),_AX6UIGrid_body2.default.init.call(this),_AX6UIGrid_body2.default.repaint.call(this),_AX6UIGrid_scroller2.default.init.call(this),_AX6UIGrid_scroller2.default.resize.call(this),(0,_jqmin2.default)(window).on("resize.ax6grid-"+this.id,_AX6Util2.default.throttle(function(t){alignGrid.call(this),_AX6UIGrid_scroller2.default.resize.call(this),_AX6UIGrid_body2.default.repaint.call(this)},30).bind(this)).on("keydown.ax6grid-"+this.instanceId,function(i){t.focused&&(t.isInlineEditing?i.which==_AX6Info2.default.eventKeys.ESC?t.keyDown("ESC",i.originalEvent):i.which==_AX6Info2.default.eventKeys.RETURN?t.keyDown("RETURN",i.originalEvent):i.which==_AX6Info2.default.eventKeys.TAB?(t.keyDown("TAB",i.originalEvent),_AX6Util2.default.stopEvent(i)):i.which==_AX6Info2.default.eventKeys.UP?t.keyDown("RETURN",{shiftKey:!0}):i.which==_AX6Info2.default.eventKeys.DOWN&&t.keyDown("RETURN",{}):i.metaKey||i.ctrlKey?67==i.which&&self.copySelect():ctrlKeys[i.which]?(t.keyDown(ctrlKeys[i.which],i.originalEvent),_AX6Util2.default.stopEvent(i)):i.which==_AX6Info2.default.eventKeys.ESC?t.focused&&_AX6UIGrid_body2.default.blur.call(self):i.which==_AX6Info2.default.eventKeys.RETURN||i.which==_AX6Info2.default.eventKeys.SPACE?t.keyDown("RETURN",i.originalEvent):i.which==_AX6Info2.default.eventKeys.TAB?_AX6Util2.default.stopEvent(i):Object.keys(t.focusedColumn).length&&t.keyDown("INLINE_EDIT",i.originalEvent))}),(0,_jqmin2.default)(document.body).on("click.ax6grid-"+this.id,function(i){var e=!1,l=_AX6Util2.default.findParentNode(i.target,function(t){return!!(e=t.getAttribute("data-ax6grid-inline-edit-picker"))||"root"===t.getAttribute("data-ax6grid-container")});l&&l.getAttribute("data-ax6grid-instance")===t.id?t.focused=!0:(t.focused=!1,_AX6UIGrid_body2.default.blur.call(t))}),setTimeout(function(){t.onLoad&&t.onLoad.call({self:t})}))}},{key:"initOnce",value:function(){if(this.initialized)return this;this.initialized=!0}},{key:"align",value:function(){return alignGrid.call(this)&&(_AX6UIGrid_body2.default.repaint.call(this),_AX6UIGrid_scroller2.default.resize.call(this)),this}},{key:"keyDown",value:function(t,i){var e={KEY_UP:function(){_AX6UIGrid_body2.default.moveFocus.call(this,"UP")},KEY_DOWN:function(){_AX6UIGrid_body2.default.moveFocus.call(this,"DOWN")},KEY_LEFT:function(){_AX6UIGrid_body2.default.moveFocus.call(this,"LEFT")},KEY_RIGHT:function(){_AX6UIGrid_body2.default.moveFocus.call(this,"RIGHT")},KEY_HOME:function(){_AX6UIGrid_body2.default.moveFocus.call(this,"HOME")},KEY_END:function(){_AX6UIGrid_body2.default.moveFocus.call(this,"END")},INLINE_EDIT:function(t){_AX6UIGrid_body2.default.inlineEdit.active.call(this,this.focusedColumn,t),/[0-9a-zA-Z]/.test(t.key)||_AX6Util2.default.stopEvent(t)},ESC:function(t){_AX6UIGrid_body2.default.inlineEdit.keydown.call(this,"ESC")},RETURN:function(t){var i=0;for(var e in this.inlineEditing){if(i++,!_AX6UIGrid_body2.default.inlineEdit.keydown.call(this,"RETURN",e))return!1;1==i&&_AX6UIGrid_body2.default.moveFocus.call(this,t.shiftKey?"UP":"DOWN")&&_AX6UIGrid_body2.default.inlineEdit.keydown.call(this,"RETURN")}0==i&&(_AX6UIGrid_body2.default.inlineEdit.keydown.call(this,"RETURN"),_AX6Util2.default.stopEvent(t))},TAB:function(t){var i=0;for(var e in this.inlineEditing)i++,_AX6UIGrid_body2.default.inlineEdit.keydown.call(this,"RETURN",e,{moveFocus:!0}),1==i&&_AX6UIGrid_body2.default.moveFocus.call(this,t.shiftKey?"LEFT":"RIGHT")&&_AX6UIGrid_body2.default.inlineEdit.keydown.call(this,"RETURN",void 0,{moveFocus:!0})}};return t in e&&e[t].call(this,i),this}},{key:"copySelect",value:function(){var t=void 0,i=this.$.form.clipboard,e=[],l="",o=void 0,a=void 0,r=0;for(var n in this.selectedColumn){var d=this.selectedColumn[n];if(d){void 0===a&&(a=d.dindex,o=d.rowIndex,d.rowIndex),a==d.dindex&&o==d.rowIndex||r++,e[r]||(e[r]=[]);var s=this.bodyRowMap[d.rowIndex+"_"+d.colIndex];s?this.list[d.dindex].__isGrouping?e[r].push(this.list[d.dindex][d.colIndex]):e[r].push(this.list[d.dindex][s.key]):e[r].push(""),a=d.dindex,o=d.rowIndex}}e.forEach(function(t){l+=t.join("\t")+"\n"}),i.get(0).innerText=l,i.select();try{t=document.execCommand("copy")}catch(i){t=!1}return t}},{key:"setData",value:function(t){var i=void 0===this.xvar.paintStartRowIndex;return _AX6UIGrid_data2.default.set.call(this,t),alignGrid.call(this),_AX6UIGrid_body2.default.repaint.call(this),i||_AX6UIGrid_body2.default.scrollTo.call(this,{top:0}),_AX6UIGrid_scroller2.default.resize.call(this),_AX6UIGrid_page2.default.navigationUpdate.call(this),i=null,this}},{key:"getList",value:function(t){return _AX6UIGrid_data2.default.getList.call(this,t)}},{key:"setHeight",value:function(t){return"100%"==t&&(t=this.$target.offsetParent().innerHeight()),this.$target.css({height:t}),this.$.container.root.css({height:t}),alignGrid.call(this),_AX6UIGrid_body2.default.repaint.call(this,"reset"),_AX6UIGrid_scroller2.default.resize.call(this),this}},{key:"addRow",value:function(t,i,e){return _AX6UIGrid_data2.default.add.call(this,t,i,e),alignGrid.call(this),_AX6UIGrid_body2.default.repaint.call(this,"reset"),e&&e.focus&&_AX6UIGrid_body2.default.moveFocus.call(this,e.focus),_AX6UIGrid_scroller2.default.resize.call(this),this}},{key:"appendToList",value:function(t){return _AX6UIGrid_data2.default.append.call(this,t,function(){alignGrid.call(this),_AX6UIGrid_body2.default.repaint.call(this),_AX6UIGrid_scroller2.default.resize.call(this)}.bind(this)),this}},{key:"removeRow",value:function(t){return _AX6UIGrid_data2.default.remove.call(this,t),alignGrid.call(this),_AX6UIGrid_body2.default.repaint.call(this,"reset"),_AX6UIGrid_body2.default.moveFocus.call(this,this.config.body.grouping?"START":"END"),_AX6UIGrid_scroller2.default.resize.call(this),this}},{key:"updateRow",value:function(t,i){return _AX6UIGrid_data2.default.update.call(this,t,i),_AX6UIGrid_body2.default.repaintRow.call(this,i),this}},{key:"updateChildRows",value:function(t,i,e){return _AX6UIGrid_data2.default.updateChild.call(this,t,i,e),this.xvar.paintStartRowIndex=void 0,this.xvar.paintStartColumnIndex=void 0,_AX6UIGrid_body2.default.repaint.call(this),this}},{key:"deleteRow",value:function(t){return _AX6UIGrid_data2.default.deleteRow.call(this,t),alignGrid.call(this),_AX6UIGrid_body2.default.repaint.call(this,"reset"),_AX6UIGrid_scroller2.default.resize.call(this),this}},{key:"setValue",value:function(t,i,e){if(_AX6UIGrid_data2.default.setValue.call(this,t,void 0,i,e)){var l=function(t,i,e,l,o,a){for(var r=0,n=i.length;r<n;r++)for(var d=0,s=i[r].cols.length;d<s;d++)i[r].cols[d].key==o&&(this.xvar.frozenRowIndex>e?_AX6UIGrid_body2.default.repaintCell.call(this,"top-"+t,e,l,r,d,a):_AX6UIGrid_body2.default.repaintCell.call(this,t+"-scroll",e,l,r,d,a))};l.call(this,"left-body",this.leftBodyRowData.rows,t,void 0,i,e),l.call(this,"body",this.bodyRowData.rows,t,void 0,i,e)}return this}},{key:"addColumn",value:function(t,i){var e={first:function(t){this.config.columns=[].concat(t).concat(this.config.columns)},last:function(t){this.config.columns=this.config.columns.concat([].concat(t))}};if(void 0===t)throw"_column must not be null";if(void 0===i&&(i="last"),i in e)e[i].call(this,t);else{if(!_AX6Util2.default.isNumber(i))throw"invalid argument _cindex";if(_AX6Util2.default.isArray(t))for(var l=0,o=t.length;l<o;l++)this.config.columns.splice(i+l,0,t[l]);else this.config.columns.splice(i,0,t)}return onResetColumns.call(this),this}},{key:"removeColumn",value:function(t){var i={first:function(t){this.config.columns.splice(t,1)},last:function(){this.config.columns.splice(this.config.columns.length-1,1)}};if(void 0===t&&(t="last"),t in i)i[t].call(this,t);else{if(!_AX6Util2.default.isNumber(t))throw"invalid argument _cindex";this.config.columns.splice(t,1)}return onResetColumns.call(this),this}},{key:"updateColumn",value:function(t,i){if(!_AX6Util2.default.isNumber(i))throw"invalid argument _cindex";return this.config.columns.splice(i,1,t),onResetColumns.call(this),this}},{key:"setColumnWidth",value:function(t,i){return this.colGroup[this.xvar.columnResizerIndex]._width=t,this.needToPaintSum=!0,_AX6UIGrid_header2.default.repaint.call(this),_AX6UIGrid_body2.default.repaint.call(this,!0),_AX6UIGrid_scroller2.default.resize.call(this),alignGrid.call(this),this}},{key:"getColumnSortInfo",value:function(){var t={sortInfo:[]};for(var i in this.sortInfo)t.sortInfo.push({key:i,orderBy:this.sortInfo[i].orderBy,seq:this.sortInfo[i].seq});return t.sortInfo.sort(function(t,i){return t.seq>i.seq}),t.sortInfo}},{key:"setColumnSort",value:function(t){return void 0!==t&&(this.sortInfo=t,_AX6UIGrid_header2.default.applySortStatus.call(this,t)),sortColumns.call(this,t||this.sortInfo),this}},{key:"select",value:function(t,i){if(_AX6Util2.default.isNumber(t)){var e=t;this.config.multipleSelect?i&&i.selectedClear&&this.clearSelect():this.clearSelect(),_AX6UIGrid_data2.default.select.call(this,e,void 0,i&&i.selected),_AX6UIGrid_body2.default.updateRowState.call(this,["selected"],e,void 0)}return this}},{key:"clickBody",value:function(t){return _AX6UIGrid_body2.default.click.call(this,t),this}},{key:"DBLClickBody",value:function(t){return _AX6UIGrid_body2.default.dblClick.call(this,t),this}},{key:"clearSelect",value:function(){return _AX6UIGrid_body2.default.updateRowState.call(this,["selectedClear"]),_AX6UIGrid_data2.default.clearSelect.call(this),this}},{key:"selectAll",value:function(t){return _AX6UIGrid_data2.default.selectAll.call(this,t&&t.selected,t),_AX6UIGrid_body2.default.updateRowStateAll.call(this,["selected"]),this}},{key:"exportExcel",value:function(t){var i=[];return i.push('<table border="1">'),i.push(_AX6UIGrid_header2.default.getExcelString.call(this)),i.push(_AX6UIGrid_body2.default.getExcelString.call(this)),i.push("</table>"),void 0===t?i.join(""):(EXCEL.export.call(this,[i.join("")],t),this)}},{key:"focus",value:function(t){if(_AX6UIGrid_body2.default.moveFocus.call(this,t)){var i=void 0;for(var e in this.focusedColumn){i=_jqmin2.default.extend({},this.focusedColumn[e],!0);break}i&&this.select(i.dindex,{selectedClear:!0})}else if(void 0===this.selectedDataIndexs[0])this.select(0);else{var l=this.selectedDataIndexs[0],o={UP:function(){l>0&&(this.select(l-1,{selectedClear:!0}),_AX6UIGrid_body2.default.moveFocus.call(this,l-1))},DOWN:function(){l<this.list.length-1&&(this.select(l+1,{selectedClear:!0}),_AX6UIGrid_body2.default.moveFocus.call(this,l+1))},HOME:function(){this.select(0,{selectedClear:!0}),_AX6UIGrid_body2.default.moveFocus.call(this,0)},END:function(){this.select(this.list.length-1,{selectedClear:!0}),_AX6UIGrid_body2.default.moveFocus.call(this,this.list.length-1)}};t in o&&o[t].call(this)}return this}},{key:"destroy",value:function(){return this.$target.empty(),this.list=[],null}}]),i}();exports.default=AX6UIGrid;
//# sourceMappingURL=AX6UIGrid.js.map
