"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,a){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!a||"object"!=typeof a&&"function"!=typeof a?e:a}function _inherits(e,a){if("function"!=typeof a&&null!==a)throw new TypeError("Super expression must either be null or a function, not "+typeof a);e.prototype=Object.create(a&&a.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),a&&(Object.setPrototypeOf?Object.setPrototypeOf(e,a):e.__proto__=a)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,a){for(var t=0;t<a.length;t++){var n=a[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(a,t,n){return t&&e(a.prototype,t),n&&e(a,n),a}}(),_jqmin=require("jqmin"),_jqmin2=_interopRequireDefault(_jqmin),_AX6UICore2=require("./AX6UICore.js"),_AX6UICore3=_interopRequireDefault(_AX6UICore2),_AX6Util=require("./AX6Util"),_AX6Util2=_interopRequireDefault(_AX6Util),debouncer={resizeDebouncedFn:null,panelDebouncedFn:null},tmpl={stack_panel:function(e,a){return"bottom"===a.labelDirection?'<div data-ax6ui-docker-pane="{{id}}" data-ax6ui-docker-label-direction="{{labelDirection}}" data-ax6ui-docker-path="{{panelPath}}" style="flex-grow: {{#flexGrow}}{{.}}{{/flexGrow}}{{^flexGrow}}1{{/flexGrow}};">\n    <div data-ax6ui-docker-pane-item-views="{{id}}"></div>\n    <ul data-ax6ui-docker-pane-tabs="{{id}}" data-ax6ui-docker-id="{{id}}" data-ax6ui-docker-path="{{panelPath}}"></ul>\n    <div data-ax6ui-docker-pane-tabs-more="{{id}}">{{{icons.more}}}</div>\n</div>':'<div data-ax6ui-docker-pane="{{id}}" data-ax6ui-docker-label-direction="{{labelDirection}}" data-ax6ui-docker-path="{{panelPath}}" style="flex-grow: {{#flexGrow}}{{.}}{{/flexGrow}}{{^flexGrow}}1{{/flexGrow}};">\n    <ul data-ax6ui-docker-pane-tabs="{{id}}" data-ax6ui-docker-id="{{id}}" data-ax6ui-docker-path="{{panelPath}}"></ul>\n    <div data-ax6ui-docker-pane-tabs-more="{{id}}">{{{icons.more}}}</div>\n    <div data-ax6ui-docker-pane-item-views="{{id}}"></div>\n</div>'},panel_label:function(){return'<li data-ax6ui-docker-pane-tab="{{pIndex}}" data-ax6ui-docker-id="{{id}}" data-ax6ui-docker-path="{{panelPath}}" class="{{#hasLabelColor}}hasLabelColor{{/hasLabelColor}}">\n    <div class="label-icon" style="{{#color}}background: {{color}};{{/color}}{{#borderColor}}border-color: {{borderColor}};{{/borderColor}}"></div>\n    <div class="title">{{{name}}}</div>\n    {{^disableClosePanel}}<div class="close-icon">{{{icons.close}}}</div>{{/disableClosePanel}}\n</li><li class="pane-tab-margin"></li>'}},fireEvent=function(e){var a={resize:function(e){this.onResize&&debouncer.resizeDebouncedFn(function(){var a={self:this,resizer:e.target,resizedDom:[e.target.prev(),e.target.next()]};this.onResize.call(a,a)}.bind(this))}};return e.eventName in a&&a[e.eventName].call(this,e),this},getPanelId=function(){return this.panelId++},defaultModule={init:function(e,a){e.$element.html(a.name)},active:function(e,a){},deactive:function(e,a){},destroy:function(e,a){}},getPanelPath=function(e,a){var t=[];return e&&void 0!==e.panelPath&&t.push(e.panelPath),t.push("panels["+(a||0)+"]"),t.join(".")},getPanel=function(e){var a=[];[].concat(_AX6Util2.default.isArray(e)?e:e.split(/[\.\[\]]/g)).forEach(function(e){""!==e&&a.push('["'+e.replace(/['\"]/g,"")+'"]')});try{return Function("","return this"+a.join("")+";").call(this)}catch(e){return}},getPanelParent=function(e){try{var a=e.panelPath.substr(0,e.panelPath.lastIndexOf("."));return Function("","return this."+a+";").call(this)}catch(e){return}},setPanel=function(e,a){var t=[];return[].concat(_AX6Util2.default.isArray(e)?e:e.split(/[\.\[\]]/g)).forEach(function(e){""!==e&&t.push('["'+e.replace(/['\"]/g,"")+'"]')}),Function("val","return this"+t.join("")+" = val;").call(this,a)},getMousePosition=function(e){var a=void 0,t=e.originalEvent?e.originalEvent:e;return a="changedTouches"in t&&t.changedTouches?t.changedTouches[0]:t,{clientX:a.pageX,clientY:a.pageY}},controlPanel=function(e,a,t){var n=this,l=_jqmin2.default.extend(e.moduleState,{name:e.name}),i={$element:e.$item},r=void 0,o={init:function(){e.builded=!0,(r=e.moduleName in n.modules&&"init"in n.modules[e.moduleName]?n.modules[e.moduleName]:defaultModule).init(i,l)},active:function(){e.active=!0,e.$label.addClass("active"),e.$item.addClass("active");var a=e.$label.parent();a.get(0)&&a.get(0).clientWidth!==a.get(0).scrollWidth&&a.animate({scrollLeft:e.$label.position().left},300),(r=e.moduleName in n.modules&&"active"in n.modules[e.moduleName]?n.modules[e.moduleName]:defaultModule).active(i,l),a=null},deactive:function(){e.active=!1,e.$label.removeClass("active"),e.$item.removeClass("active"),(r=e.moduleName in n.modules&&"deactive"in n.modules[e.moduleName]?n.modules[e.moduleName]:defaultModule).deactive(i,l)},destroy:function(){(r=e.moduleName in n.modules&&"destroy"in n.modules[e.moduleName]?n.modules[e.moduleName]:defaultModule).destroy(i,l),setPanel(e.panelPath,null),arrangePanel()},remove:function(){(r=e.moduleName in n.modules&&"destroy"in n.modules[e.moduleName]?n.modules[e.moduleName]:defaultModule).destroy(i,l),setPanel(e.panelPath,null),arrangePanel()}},s={panel:e,controlType:a},d=function(){o[a](),r=null,_AX6Util2.default.isFunction(cfg.control.after)&&cfg.control.after.call(s,s)};o[a]&&(_AX6Util2.default.isFunction(cfg.control.before)?cfg.control.before.call(s,s,function(e){void 0===e&&(e=!0),e&&d(),_AX6Util2.default.isFunction(t)&&t(e)}):d())},repaintPanels=function(){var e={stack:function(a,t,n,l){var i=void 0,r=-1;n.panelPath=getPanelPath(t,l),i=(0,_jqmin2.default)(DOCKER.tmpl.get.call(this,"stack-panel",{id:self.instanceId,name:n.name,hasLabelColor:!_AX6Util2.default.isNothing(n.color),color:n.color,borderColor:n.borderColor,panelPath:n.panelPath,icons:cfg.icons,labelDirection:n.labelDirection||cfg.labelDirection,disableClosePanel:cfg.disableClosePanel,disableDragPanel:cfg.disableDragPanel},{})),a.append(i),_AX6Util2.default.isArray(n.panels)&&(n.panels.forEach(function(e,a){e.active&&(r=a)}),-1===r&&(r=0),n.panels[r].active=!0,n.panels.forEach(function(a,t){a.panelIndex=t,e[a.type](i,n,a,t)})),i=null,r=null},panel:function(e,a,t,n){var l=void 0;t.panelPath=getPanelPath(a,n),t.$label=(0,_jqmin2.default)(DOCKER.tmpl.get.call(this,"panel-label",{id:self.instanceId,pIndex:n,name:t.name,hasLabelColor:!_AX6Util2.default.isNothing(t.color),color:t.color,borderColor:t.borderColor,panelPath:t.panelPath,icons:cfg.icons,disableClosePanel:cfg.disableClosePanel,disableDragPanel:cfg.disableDragPanel},{})),t.$item?(t.$item.attr("data-ax6ui-docker-path",t.panelPath),t.$item.attr("data-ax6ui-docker-pane-item",n)):t.$item=(0,_jqmin2.default)('<div data-ax6ui-docker-pane-item="'+n+'" data-ax6ui-docker-id="'+self.instanceId+'" data-ax6ui-docker-pane-id="'+getPanelId()+'" data-ax6ui-docker-path="'+t.panelPath+'"></div>'),a&&"stack"==a.type?(t.active&&(t.builded||controlPanel(t,"init"),controlPanel(t,"active")),e.find('[data-ax6ui-docker-pane-tabs="'+self.instanceId+'"]').append(t.$label),e.find('[data-ax6ui-docker-pane-item-views="'+self.instanceId+'"]').append(t.$item)):(l=(0,_jqmin2.default)(DOCKER.tmpl.get.call(this,"stack-panel",{id:self.instanceId,name:t.name,hasLabelColor:!_AX6Util2.default.isNothing(t.color),color:t.color,borderColor:t.borderColor,panelPath:t.panelPath,flexGrow:t.flexGrow,icons:cfg.icons,labelDirection:t.labelDirection||cfg.labelDirection,disableClosePanel:cfg.disableClosePanel,disableDragPanel:cfg.disableDragPanel},{})),t.builded||controlPanel(t,"init"),controlPanel(t,"active"),l.find('[data-ax6ui-docker-pane-tabs="'+self.instanceId+'"]').append(t.$label),l.find('[data-ax6ui-docker-pane-item-views="'+self.instanceId+'"]').append(t.$item),e.append(l)),l=null},resizeHandle:function(e,a,t,n){var l=(0,_jqmin2.default)('<div data-ax6ui-docker-id="'+self.instanceId+'" data-ax6ui-docker-resize-handle="'+a.type+"/"+a.panelPath+"/"+n+'"></div>');e.append(l),l=null},row:function(a,t,n,l){var i=void 0;if(n.panelPath=getPanelPath(t,l),t&&"stack"==t.type)throw"The 'stack' type child nodes are allowed only for the 'panel' type.";i=(0,_jqmin2.default)('<div data-ax6ui-docker-pane-axis="row" data-ax6ui-docker-id="'+self.instanceId+'" data-ax6ui-docker-path="'+n.panelPath+'" style="flex-grow: '+(n.flexGrow||1)+';"></div>'),a.append(i),_AX6Util2.default.isArray(n.panels)&&n.panels.forEach(function(a,t){t>0&&e.resizeHandle(i,n,a,t),a.panelIndex=t,e[a.type](i,n,a,t)}),i=null},column:function(a,t,n,l){var i=void 0;if(n.panelPath=getPanelPath(t,l),t&&"stack"==t.type)throw"The 'stack' type child nodes are allowed only for the 'panel' type.";i=(0,_jqmin2.default)('<div data-ax6ui-docker-pane-axis="column" data-ax6ui-docker-id="'+self.instanceId+'" data-ax6ui-docker-path="'+n.panelPath+'" style="flex-grow: '+(n.flexGrow||1)+';"></div>'),a.append(i),_AX6Util2.default.isArray(n.panels)&&n.panels.forEach(function(a,t){t>0&&e.resizeHandle(i,n,a,t),a.panelIndex=t,e[a.type](i,n,a,t)}),i=null}},a=(0,_jqmin2.default)('<div data-ax6ui-docker-panes="'+this.instanceId+'"></div>');this.panels[0]&&e[this.panels[0].type](a,null,this.panels[0],0),this.$target.html(a),this.$target.off("click.ax5docker-pane").on("click.ax5docker-pane",'[data-ax6ui-docker-id="'+self.instanceId+'"][data-ax6ui-docker-pane-tab] .close-icon',function(e){self.removePanel($(this).parents("[data-ax6ui-docker-pane-tab]").attr("data-ax6ui-docker-path")),_AX6Util2.default.stopEvent(e)}).on("click.ax5docker-pane",'[data-ax6ui-docker-id="'+self.instanceId+'"][data-ax6ui-docker-pane-tab]',function(e){var a=(0,_jqmin2.default)(this),t=getPanel(a.parents("[data-ax6ui-docker-pane]").attr("data-ax6ui-docker-path")),n=a.attr("data-ax6ui-docker-pane-tab");a.hasClass("active")||changeActiveStackPanel(t,n),a=null,t=null,n=null,_AX6Util2.default.stopEvent(e)}).on("click.ax5docker-pane",'[data-ax6ui-docker-pane-tabs-more="'+this.instanceId+'"]',function(e){openStackPanelMore($(this).parents("[data-ax6ui-docker-pane]"),e),_AX6Util2.default.stopEvent(e)}),this.$target.off("mousedown.ax5docker-pane-resize").off("dragstart.ax5docker-pane-resize").on("dragstart.ax5docker-pane-resize",'[data-ax6ui-docker-id="'+self.instanceId+'"][data-ax6ui-docker-pane-tab]',function(e){cfg.disableDragPanel||panelTabDragEvent.on(this)}).on("mousedown.ax5docker-pane-resize",'[data-ax6ui-docker-id="'+self.instanceId+'"][data-ax6ui-docker-resize-handle]',function(e){var a=this.getAttribute("data-ax6ui-docker-resize-handle").split(/\//g);self.xvar.mousePosition=getMousePosition(e),self.xvar.resizerType=a[0],self.xvar.resizerPath=a[1],self.xvar.resizerIndex=a[2],self.xvar.resizer$dom=$(this),self.xvar.resizerParent$dom=self.xvar.resizer$dom.parent(),self.xvar.resizerPrevGrow=_AX6Util2.default.number(self.xvar.resizer$dom.prev().css("flex-grow")),self.xvar.resizerNextGrow=_AX6Util2.default.number(self.xvar.resizer$dom.next().css("flex-grow")),"row"==self.xvar.resizerType?self.xvar.resizerCanvasWidth=self.xvar.resizer$dom.prev().innerWidth()+self.xvar.resizer$dom.next().innerWidth()+self.xvar.resizer$dom.width():self.xvar.resizerCanvasHeight=self.xvar.resizer$dom.prev().innerHeight()+self.xvar.resizer$dom.next().innerHeight()+self.xvar.resizer$dom.height(),panelResizerEvent.on(this),_AX6Util2.default.stopEvent(e)}).on("dragstart.ax5docker-pane-resize",'[data-ax6ui-docker-id="'+self.instanceId+'"][data-ax6ui-docker-resize-handle]',function(e){return _AX6Util2.default.stopEvent(e),!1}),alignStackPane(),a=null},panelTabDragEvent={on:function(e){(void 0).panels[0]&&(void 0).panels[0].panels&&(void 0).panels[0].panels.length&&((void 0).xvar.dragger={dragPanel:e,target:null,dragOverVertical:null,dragOverHorizontal:null},(void 0).$target.on("dragover.ax5docker-"+(void 0).instanceId,'[data-ax6ui-docker-id="'+(void 0).instanceId+'"][data-ax6ui-docker-path]',function(e){panelTabDragEvent.dragover(this,e),_AX6Util2.default.stopEvent(e)}).on("drop.ax5docker-"+(void 0).instanceId,function(e){panelTabDragEvent.off("drop"),_AX6Util2.default.stopEvent(e)}).on("dragend.ax5docker-"+(void 0).instanceId,function(e){panelTabDragEvent.off(),_AX6Util2.default.stopEvent(e)}))},dragover:function(e,a){var t=(0,_jqmin2.default)(e),n={},l=getMousePosition(a),i=void 0,r=void 0;if(null!=(void 0).xvar.dragger.target&&(void 0).xvar.dragger.target.get(0)==t.get(0)||((void 0).xvar.dragger.target&&(void 0).xvar.dragger.target.removeAttr("data-dropper"),(void 0).xvar.dragger.target=t,(void 0).xvar.dragger.dragOverVertical=null,(void 0).xvar.dragger.dragOverHorizontal=null),n=t.offset(),n.width=t.width(),n.height=t.height(),t.attr("data-ax6ui-docker-pane-tab")){var o=n.width/2;if(n.left<=l.clientX&&n.left+o>=l.clientX?r="left":n.left+o<=l.clientX&&n.left+2*o>=l.clientX&&(r="right"),(void 0).xvar.dragger.dragOverHorizontal!=r&&void 0!==r){(void 0).xvar.dragger.dragOverHorizontal=r;var s={left:function(e){e.attr("data-dropper","left")},right:function(e){e.attr("data-dropper","right")}};(void 0).xvar.dragger.dragOverHorizontal in s&&s[(void 0).xvar.dragger.dragOverHorizontal]((void 0).xvar.dragger.target)}o=null}else if(t.attr("data-ax6ui-docker-pane-tabs"))(void 0).xvar.dragger.dragOverHorizontal="last-child",(void 0).xvar.dragger.target.attr("data-dropper","true");else if(t.attr("data-ax6ui-docker-pane-item")){var d=n.height/3,c=n.width/3;if(n.top<=l.clientY&&n.top+d>=l.clientY?i="top":n.top+d<=l.clientY&&n.top+2*d>=l.clientY?i="middle":n.top+2*d<=l.clientY&&n.top+3*d>=l.clientY&&(i="bottom"),n.left<=l.clientX&&n.left+c>=l.clientX?r="left":n.left+c<=l.clientX&&n.left+2*c>=l.clientX?r="center":n.left+2*c<=l.clientX&&n.left+3*c>=l.clientX&&(r="right"),(void 0).xvar.dragger.dragOverVertical!=i||(void 0).xvar.dragger.dragOverHorizontal!=r){(void 0).xvar.dragger.dragOverVertical=i,(void 0).xvar.dragger.dragOverHorizontal=r;var u={"left-top":function(e){e.attr("data-dropper","left")},"right-top":function(e){e.attr("data-dropper","right")},"center-top":function(e){e.attr("data-dropper","top")},"left-middle":function(e){e.attr("data-dropper","left")},"right-middle":function(e){e.attr("data-dropper","right")},"center-middle":function(e){e.attr("data-dropper","center")},"left-bottom":function(e){e.attr("data-dropper","left")},"right-bottom":function(e){e.attr("data-dropper","right")},"center-bottom":function(e){e.attr("data-dropper","bottom")}};(void 0).xvar.dragger.dragOverHorizontal+"-"+(void 0).xvar.dragger.dragOverVertical in u&&u[(void 0).xvar.dragger.dragOverHorizontal+"-"+(void 0).xvar.dragger.dragOverVertical]((void 0).xvar.dragger.target)}d=null,c=null}},off:function(e){if(e){var a=getPanel((void 0).xvar.dragger.dragPanel.getAttribute("data-ax6ui-docker-path")),t=[];(void 0).xvar.dragger.dragOverHorizontal&&t.push((void 0).xvar.dragger.dragOverHorizontal),(void 0).xvar.dragger.dragOverVertical&&t.push((void 0).xvar.dragger.dragOverVertical),(void 0).appendPanel(a,(void 0).xvar.dragger.target.attr("data-ax6ui-docker-path"),t),a=null,t=null}alignStackPane(),(void 0).$target.off("dragover.ax5docker-"+(void 0).instanceId).off("drop.ax5docker-"+(void 0).instanceId).off("dragend.ax5docker-"+(void 0).instanceId),(void 0).xvar.dragger.target.removeAttr("data-dropper")}},panelResizerEvent={on:function(e){(0,_jqmin2.default)(document.body).on("mousemove.ax5docker-"+(void 0).instanceId,function(e){var a=getMousePosition(e),t=void 0;self.xvar.resizerLived?("row"==self.xvar.resizerType?(self.xvar.__da=a.clientX-self.xvar.mousePosition.clientX,t=_AX6Util2.default.number(2*self.xvar.__da/self.xvar.resizerCanvasWidth,{round:6}),self.xvar.resizer$dom.prev().css({"flex-grow":self.xvar.resizerPrevGrow+t}),self.xvar.resizer$dom.next().css({"flex-grow":self.xvar.resizerNextGrow-t})):(self.xvar.__da=a.clientY-self.xvar.mousePosition.clientY,t=_AX6Util2.default.number(2*self.xvar.__da/self.xvar.resizerCanvasHeight,{round:6}),self.xvar.resizer$dom.prev().css({"flex-grow":self.xvar.resizerPrevGrow+t}),self.xvar.resizer$dom.next().css({"flex-grow":self.xvar.resizerNextGrow-t})),fireEvent({eventName:"resize",target:self.xvar.resizer$dom})):self.xvar.resizerLived=!0,a=null,t=null}).on("mouseup.ax5docker-"+(void 0).instanceId,function(e){panelResizerEvent.off(),_AX6Util2.default.stopEvent(e)}).on("mouseleave.ax5docker-"+(void 0).instanceId,function(e){panelResizerEvent.off(),_AX6Util2.default.stopEvent(e)}),(0,_jqmin2.default)(document.body).attr("unselectable","on").css("user-select","none").on("selectstart",!1)},off:function(){if(self.xvar.resizerLived=!1,void 0===(void 0).xvar.__da);else{var e=self.xvar.resizer$dom.prev(),a=self.xvar.resizer$dom.next(),t=getPanel(e.attr("data-ax6ui-docker-path")),n=getPanel(a.attr("data-ax6ui-docker-path"));t.flexGrow=_AX6Util2.default.number(e.css("flex-grow")),n.flexGrow=_AX6Util2.default.number(a.css("flex-grow")),e=null,a=null,t=null,n=null}alignStackPane(),(0,_jqmin2.default)(document.body).off("mousemove.ax5docker-"+(void 0).instanceId).off("mouseup.ax5docker-"+(void 0).instanceId).off("mouseleave.ax5docker-"+(void 0).instanceId),(0,_jqmin2.default)(document.body).removeAttr("unselectable").css("user-select","auto").off("selectstart")}},changeActiveStackPanel=function(e,a){for(var t=e.panels[a],n=0,l=e.panels.length;n<l;n++)e.panels[n].active&&controlPanel(e.panels[n],"deactive");return t.builded||controlPanel(t,"init"),controlPanel(t,"active"),e=null,a=null,t=null,this},openStackPanelMore=function(e,a){var t=(0,_jqmin2.default)(e),n=t.attr("data-ax6ui-docker-path"),l=getPanel(n);if(!this.menu)throw console.log(l.panels),"'ax5ui-menu' is required to implement the function.";var i=_AX6Util2.default.map(l.panels,function(e){return{label:this.name,index:e,panePath:n}});return this.menu.setConfig({items:i,onClick:function(){changeActiveStackPanel(getPanel(this.panePath),this.index)}}),this.menu.popup(a),t=null,n=null,l=null,this},alignStackPane=function(){debouncer.panelDebouncedFn(function(){this.$target.find('[data-ax6ui-docker-pane-tabs="'+this.instanceId+'"]').each(function(){var e=(0,_jqmin2.default)(this).parent();this.scrollWidth>this.clientWidth?e.addClass("tabs-scrolled"):e.removeClass("tabs-scrolled"),e=null})}.bind(this))},panelsDeactive=function(e){_AX6Util2.default.isArray(e)?e.forEach(function(e){controlPanel(e,"deactive")}):controlPanel(e,"deactive")},arrangePanel=function(){var e={stack:function(a){if(!_AX6Util2.default.isArray(a.panels))return!1;var t={type:"stack",panels:[]};return a.panels.forEach(function(a,n){if(a){var l=e[a.type](a);l&&t.panels.push(l),l=null}}),0==t.panels.length?null:(t.panels.length<2&&(t=t.panels[0]),t)},panel:function(e){return e},row:function(a){if(!_AX6Util2.default.isArray(a.panels))return!1;var t={type:"row",panels:[]};return a.panels.forEach(function(a,n){if(a){var l=e[a.type](a);l&&t.panels.push(l),l=null}}),0==t.panels.length?null:(t.panels.length<2&&(t=t.panels[0]),t)},column:function(a){if(!_AX6Util2.default.isArray(a.panels))return!1;var t={type:"column",panels:[]};return a.panels.forEach(function(a,n){if(a){var l=e[a.type](a);l&&t.panels.push(l),l=null}}),0==t.panels.length?null:(t.panels.length<2&&(t=t.panels[0]),t)}};this.panels[0]?(this.panels[0]=e[this.panels[0].type](this.panels[0]),this.panels[0]&&"panel"===this.panels[0].type&&(this.panels[0]={type:"stack",panels:[this.panels[0]]})):this.panels=[],repaintPanels()},AX6UIDocker=function(e){function a(e){_classCallCheck(this,a);var t=_possibleConstructorReturn(this,(a.__proto__||Object.getPrototypeOf(a)).call(this));return t.config={theme:"default",animateTime:250,columnKeys:{},control:{},icons:{close:"X",more:"..."},labelDirection:"top",disableClosePanel:!1,disableDragPanel:!1,resizeDebounceTime:100,panelDebounceTime:300},_jqmin2.default.extend(!0,t.config,e),t.xvar={},t.menu=null,t.onResize=null,t.panels=[],t.panelId=0,t.modules={},void 0!==e&&t.init(),t}return _inherits(a,_AX6UICore3.default),_createClass(a,[{key:"init",value:function(){this.onStateChanged=this.config.onStateChanged,this.onResize=this.config.onResize,this.onClick=this.config.onClick,this.onLoad=this.config.onLoad,this.onDataChanged=this.config.onDataChanged,this.$target=(0,_jqmin2.default)(this.config.target),this.panels=this.config.panels||[],debouncer.resizeDebouncedFn=_AX6Util2.default.throttle(function(e){e()},this.config.resizeDebounceTime),debouncer.panelDebouncedFn=_AX6Util2.default.debounce(function(e){e()},this.config.panelDebounceTime),this.initOnce()}},{key:"initOnce",value:function(){if(this.initialized)return this;this.initialized=!0,(0,_jqmin2.default)(window).off("resize.ax6ui-docker-"+this.instanceId).on("resize.ax6ui-docker-"+this.instanceId,_AX6Util2.default.throttle(function(e){},30).bind(this))}},{key:"setPanels",value:function(e){return this.panels=e||[],repaintPanels.call(this),this}},{key:"addModule",value:function(e){return _AX6Util2.default.isObject(e)&&_jqmin2.default.extend(!0,this.modules,e),this}},{key:"repaint",value:function(){return repaintPanels.call(this),this}},{key:"addPanel",value:function(e,a,t,n){var l="",i=void 0,r=void 0,o={stack:function(e,a,t,n){var i=_jqmin2.default.extend({},e),r={stack:function(e,a){a.active&&panelsDeactive(e.panels),e.panels.push(a),arrangePanel()},"stack-left":function(e,a){a.active&&panelsDeactive(e.panels),e.panels.splice(n,0,a),arrangePanel()},"stack-right":function(e,a){a.active&&panelsDeactive(e.panels),e.panels.splice(Number(n)+1,0,a),arrangePanel()},"row-left":function(e,t){var n=l.substr(0,l.lastIndexOf(".")),r=getPanel(n);r&&"row"==r.type?this.addPanel(r.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"row",panels:[]})).panels.push(t),e.panels.push(i),arrangePanel())},"row-right":function(e,t){var n=l.substr(0,l.lastIndexOf(".")),r=getPanel(n);r&&"row"==r.type?this.addPanel(r.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"row",panels:[]})).panels.push(i),e.panels.push(t),arrangePanel())},"column-top":function(e,t){var n=l.substr(0,l.lastIndexOf(".")),r=getPanel(n);r&&"column"==r.type?this.addPanel(r.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"column",panels:[]})).panels.push(t),e.panels.push(i),arrangePanel())},"column-bottom":function(e,t){var n=l.substr(0,l.lastIndexOf(".")),r=getPanel(n);r&&"column"==r.type?this.addPanel(r.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"column",panels:[]})).panels.push(i),e.panels.push(t),arrangePanel())}};a in r&&r[a].call(this,e,t),i=null,r=null},row:function(e,a,t,n){var i=_jqmin2.default.extend({},e),r={stack:function(e,t){e.panels[0]&&e.panels[0].panelPath&&this.addPanel(e.panels[0].panelPath,a,t)},"row-left":function(e,a,t){e.panels.splice(t,0,a),arrangePanel()},"row-right":function(e,a,t){e.panels.splice(t+1,0,a),arrangePanel()},"column-top":function(e,t,n){var r=l.substr(0,l.lastIndexOf(".")),o=getPanel(r);o&&"column"==o.type?this.addPanel(o.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"column",panels:[]})).panels.push(t),e.panels.push(i),arrangePanel())},"column-bottom":function(e,t,n){var r=l.substr(0,l.lastIndexOf(".")),o=getPanel(r);o&&"column"==o.type?this.addPanel(o.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"column",panels:[]})).panels.push(i),e.panels.push(t),arrangePanel())}};a in r&&r[a].call(this,e,t,n),r=null,i=null},column:function(e,a,t,n){var i=_jqmin2.default.extend({},e),r={stack:function(e,t){e.panels[0]&&e.panels[0].panelPath&&this.addPanel(e.panels[0].panelPath,a,t)},"row-left":function(e,t){var n=l.substr(0,l.lastIndexOf(".")),r=getPanel(n);r&&"row"==r.type?this.addPanel(r.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"row",panels:[]})).panels.push(t),e.panels.push(i),arrangePanel())},"row-right":function(e,t){var n=l.substr(0,l.lastIndexOf(".")),r=getPanel(n);r&&"row"==r.type?this.addPanel(r.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"row",panels:[]})).panels.push(i),e.panels.push(t),arrangePanel())},"column-top":function(e,a){e.panels.splice(n,0,a),arrangePanel()},"column-bottom":function(e,a){e.panels.splice(n+1,0,a),arrangePanel()}};a in r&&r[a].call(this,e,t),r=null,i=null},panel:function(e,a,t){var n=_jqmin2.default.extend({},e),i={stack:function(e,a){e=setPanel(l,{type:"stack",panels:[]}),a.active&&panelsDeactive(n),e.panels.push(n),e.panels.push(a),arrangePanel()},"stack-left":function(e,a){e=setPanel(l,{type:"stack",panels:[]}),a.active&&panelsDeactive(n),e.panels.push(a),e.panels.push(n),arrangePanel()},"stack-right":function(e,a){e=setPanel(l,{type:"stack",panels:[]}),a.active&&panelsDeactive(n),e.panels.push(n),e.panels.push(a),arrangePanel()},"row-left":function(e,t){var i=l.substr(0,l.lastIndexOf(".")),r=getPanel(i);r&&"row"==r.type||"column"==r.type?this.addPanel(r.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"row",panels:[]})).panels.push(t),e.panels.push(n),arrangePanel())},"row-right":function(e,t){var i=l.substr(0,l.lastIndexOf(".")),r=getPanel(i);r&&"row"==r.type||"column"==r.type?this.addPanel(r.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"row",panels:[]})).panels.push(n),e.panels.push(t),arrangePanel())},"column-top":function(e,t){var i=l.substr(0,l.lastIndexOf(".")),r=getPanel(i);r&&"column"==r.type||"row"==r.type?this.addPanel(r.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"column",panels:[]})).panels.push(t),e.panels.push(n),arrangePanel())},"column-bottom":function(e,t){var i=l.substr(0,l.lastIndexOf(".")),r=getPanel(i);r&&"column"==r.type||"row"==r.type?this.addPanel(r.panelPath,a,t,e.panelIndex):((e=setPanel(l,{type:"column",panels:[]})).panels.push(n),e.panels.push(t),arrangePanel())}};a in i&&i[a].call(this,e,t),n=null,i=null}};return 0!==this.panels.length&&this.panels[0]?(l="undefined"==e?"0":e.replace(/[a-zA-Z\[\]]+/g,"").replace(/(\d+)/g,function(e,a){return"panels["+e+"]"}),i=getPanel.call(this,l),(r=getPanelParent.call(this,i))&&"stack"==r.type&&(l=(i=r).panelPath),(i?i.type:"stack"in o)&&o[i?i.type:"stack"].call(this,i,a,t,n),this):this.setPanels([{type:"stack",panels:[t]}])}},{key:"removePanel",value:function(e,a){var t=getPanel.call(this,e);return controlPanel.call(this,t,"destroy",a),t=null,this}},{key:"appendPanel",value:function(e,a,t){var n=$.extend({},e,{panelPath:""}),l=void 0,i=e.panelPath,r=_AX6Util2.default.right(a,".").replace(/\D/g,"");if(0==t.length)return this;if(e.panelPath===a){var o=a.substr(0,a.lastIndexOf("."));if("stack"!=getPanel.call(this,o).type)return this}if(1==t.length)l="last-child"==t[0]?"stack":"stack-"+t[0],n.active=!1,n.$item.removeClass("active"),controlPanel.call(this,n,"deactive");else switch(t[0]+"-"+t[1]){case"left-top":case"left-middle":case"left-bottom":l="row-left";break;case"center-top":l="column-top";break;case"center-middle":l="stack",n.active=!1,n.$item.removeClass("active"),r=void 0,controlPanel.call(this,n,"deactive");break;case"center-bottom":l="column-bottom";break;case"right-top":case"right-middle":case"right-bottom":l="row-right"}return e.panelPath===a&&(a=_AX6Util2.default.left(a,".")),setPanel.call(this,i,null),this.addPanel(a,l,n,r),n=null,this}},{key:"align",value:function(){return alignStackPane.call(this),this}},{key:"searchPanel",value:function(e){if(_AX6Util2.default.isFunction(e)){return function a(t){for(var n=0,l=t.length,i=void 0;n<l;n++)if(t[n])if("panel"===t[n].type){if(e.call({config:self.config,panel:t[n]},t[n]))return t[n]}else if(i=a(t[n].panels))return i}(this.panels)}if(_AX6Util2.default.isString(e))return getPanel.call(this,e)}},{key:"activePanel",value:function(e,a){var t="",n=void 0,l=void 0;return 0!==this.panels.length&&this.panels[0]?(t=void 0===e?"0":e.replace(/[a-zA-Z\[\]]+/g,"").replace(/(\d+)/g,function(e,a){return"panels["+e+"]"}),n=getPanel.call(this,t),l=getPanelParent.call(this,n),changeActiveStackPanel.call(this,l,n.panelIndex),this):this}}]),a}();exports.default=AX6UIDocker;
//# sourceMappingURL=AX6UIDocker.js.map
