"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),_jqmin=require("jqmin"),_jqmin2=_interopRequireDefault(_jqmin),_AX6UICore2=require("./AX6UICore.js"),_AX6UICore3=_interopRequireDefault(_AX6UICore2),_AX6Info=require("./AX6Info"),_AX6Info2=_interopRequireDefault(_AX6Info),_AX6Util=require("./AX6Util"),_AX6Util2=_interopRequireDefault(_AX6Util),_AX6Mustache=require("./AX6Mustache"),_AX6Mustache2=_interopRequireDefault(_AX6Mustache);require("./AX6UISelect/index.scss");var $window=(0,_jqmin2.default)(window),displayTmpl=function(e){return'\n<a {{^tabIndex}}href="#ax6select-{{id}}" {{/tabIndex}}{{#tabIndex}}tabindex="{{tabIndex}}" {{/tabIndex}}class="form-control {{formSize}} ax6select-display {{theme}}" \ndata-ax6ui-select-display="{{id}}" data-ax6ui-select-instance="{{instanceId}}">\n    <div class="ax6select-display-table" data-els="display-table">\n        <div data-ax6ui-select-display="label">{{label}}</div>\n        <div data-ax6ui-select-display="addon"> \n            {{#multiple}}{{#reset}}\n            <span class="addon-icon-reset" data-selected-clear="true">{{{.}}}</span>\n            {{/reset}}{{/multiple}}\n            {{#icons}}\n            <span class="addon-icon-closed">{{clesed}}</span>\n            <span class="addon-icon-opened">{{opened}}</span>\n            {{/icons}}\n            {{^icons}}\n            <span class="addon-icon-closed"><span class="addon-icon-arrow"></span></span>\n            <span class="addon-icon-opened"><span class="addon-icon-arrow"></span></span>\n            {{/icons}}\n        </div>\n    </div>\n    <input type="text" tabindex="-1" data-ax6ui-select-display="input" \n    style="position:absolute;z-index:0;left:0px;top:0px;font-size:1px;opacity: 0;width:1px;border: 0px none;color : transparent;text-indent: -9999em;" />\n</a>\n'},selectTmpl=function(e){return'\n<select tabindex="-1" class="" name="{{name}}" {{#multiple}}multiple="multiple"{{/multiple}}></select>\n'},optionGroupTmpl=function(e){return'\n<div class="ax6select-option-group {{theme}}" data-ax6ui-select-option-group="{{id}}">\n    <div class="ax-select-body">\n        <div class="ax-select-option-group-content" data-els="content"></div>\n    </div>\n    <div class="ax-select-arrow"></div> \n</div>\n'},optionsTmpl=function(e){return'\n{{#waitOptions}}\n    <div class="ax-select-option-item">\n            <div class="ax-select-option-item-holder">\n                <span class="ax-select-option-item-cell ax-select-option-item-label">\n                    {{{lang.loading}}}\n                </span>\n            </div>\n        </div>\n{{/waitOptions}}\n{{^waitOptions}}\n    {{#options}}\n        {{#optgroup}}\n            <div class="ax-select-option-group">\n                <div class="ax-select-option-item-holder">\n                    <span class="ax-select-option-group-label">\n                        {{{.}}}\n                    </span>\n                </div>\n                {{#options}}\n                <div class="ax-select-option-item" data-option-focus-index="{{@findex}}" data-option-group-index="{{@gindex}}" data-option-index="{{@index}}" \n                data-option-value="{{'+e.optionValue+'}}" \n                {{#'+e.optionSelected+'}}data-option-selected="true"{{/'+e.optionSelected+'}}>\n                    <div class="ax-select-option-item-holder">\n                        {{#multiple}}\n                        <span class="ax-select-option-item-cell ax-select-option-item-checkbox">\n                            <span class="item-checkbox-wrap useCheckBox" data-option-checkbox-index="{{@i}}"></span>\n                        </span>\n                        {{/multiple}}\n                        <span class="ax-select-option-item-cell ax-select-option-item-label">{{{'+e.optionText+'}}}</span>\n                    </div>\n                </div>\n                {{/options}}\n            </div>                            \n        {{/optgroup}}\n        {{^optgroup}}\n        <div class="ax-select-option-item" data-option-focus-index="{{@findex}}" data-option-index="{{@index}}" data-option-value="{{'+e.optionValue+'}}" {{#'+e.optionSelected+'}}data-option-selected="true"{{/'+e.optionSelected+'}}>\n            <div class="ax-select-option-item-holder">\n                {{#multiple}}\n                <span class="ax-select-option-item-cell ax-select-option-item-checkbox">\n                    <span class="item-checkbox-wrap useCheckBox" data-option-checkbox-index="{{@i}}"></span>\n                </span>\n                {{/multiple}}\n                <span class="ax-select-option-item-cell ax-select-option-item-label">{{{'+e.optionText+'}}}</span>\n            </div>\n        </div>\n        {{/optgroup}}\n    {{/options}}\n    {{^options}}\n        <div class="ax-select-option-item">\n            <div class="ax-select-option-item-holder">\n                <span class="ax-select-option-item-cell ax-select-option-item-label">\n                    {{{lang.noOptions}}}\n                </span>\n            </div>\n        </div>\n    {{/options}}\n{{/waitOptions}}\n'},onStateChanged=function(e,t){return e&&e.onStateChanged?e.onStateChanged.call(t,t):this.onStateChanged&&this.onStateChanged.call(t,t),"changeValue"==t.state&&(e&&e.onChange?e.onChange.call(t,t):this.onChange&&this.onChange.call(t,t)),e=null,t=null,!0},alignSelectDisplay=function(){for(var e=this.queue.length,t=void 0;e--;)this.queue[e].$display&&(t=Math.max(this.queue[e].$select.outerWidth(),_AX6Util2.default.number(this.queue[e].minWidth)),this.queue[e].$display.css({"min-width":t}),this.queue[e].reset&&this.queue[e].$display.find(".addon-icon-reset").css({"line-height":this.queue[e].$display.height()+"px"}));return e=null,t=null,this},alignSelectOptionGroup=function(e){if(!this.activeSelectOptionGroup)return this;var t=this.queue[this.activeSelectQueueIndex],i={},n={},o={},l=void 0;e&&(0,_jqmin2.default)(document.body).append(this.activeSelectOptionGroup),i=t.$target.offset(),n={width:t.$target.outerWidth(),height:t.$target.outerHeight()},o={winWidth:Math.max($window.width(),(0,_jqmin2.default)(document.body).width()),winHeight:Math.max($window.height(),(0,_jqmin2.default)(document.body).height()),width:this.activeSelectOptionGroup.outerWidth(),height:this.activeSelectOptionGroup.outerHeight()},t.direction&&""!==t.direction&&"auto"!==t.direction?l=t.direction:(l="top",i.top-o.height-0<0?l="top":i.top+n.height+o.height+0>o.winHeight&&(l="bottom")),e&&this.activeSelectOptionGroup.addClass("direction-"+l),this.activeSelectOptionGroup.css(function(){if("top"==l){if(i.top+n.height+o.height+0>o.winHeight){var e=i.top+n.height/2-o.height/2;return e+o.height+0>o.winHeight&&(e=0),e<0&&(e=0),{left:i.left,top:e,width:n.width}}return{left:i.left,top:i.top+n.height+1,width:n.width}}if("bottom"==l)return{left:i.left,top:i.top-o.height-1,width:n.width}}.call(this))},onBodyClick=function(e,t){if(!this.activeSelectOptionGroup)return this;var i=this.queue[this.activeSelectQueueIndex],n="display";return(t=_AX6Util2.default.findParentNode(e.target,function(e){return e.getAttribute("data-option-value")||""==e.getAttribute("data-option-value")?(n="optionItem",!0):i.$target.get(0)==e?(n="display",!0):void 0}))?("optionItem"===n&&(this.val(i.id,{index:{gindex:t.getAttribute("data-option-group-index"),index:t.getAttribute("data-option-index")}},void 0,"internal"),i.$select.trigger("change"),i.$display.focus(),i.multiple||this.close()),this):(this.close(),this)},onBodyKeyup=function(e){if(e.keyCode==_AX6Info2.default.eventKeys.ESC)this.close();else if(e.which==_AX6Info2.default.eventKeys.RETURN)if(this.queue[this.activeSelectQueueIndex].optionFocusIndex>-1){var t=this.activeSelectOptionGroup.find('[data-option-focus-index="'+this.queue[this.activeSelectQueueIndex].optionFocusIndex+'"]');this.val(this.queue[this.activeSelectQueueIndex].id,{index:{gindex:t.attr("data-option-group-index"),index:t.attr("data-option-index")}},void 0,"internal"),this.queue[this.activeSelectQueueIndex].$select.trigger("change"),this.queue[this.activeSelectQueueIndex].multiple||this.close()}else this.close()},getLabel=function(e){var t=this.queue[e],i=[];return _AX6Util2.default.isArray(t.selected)&&t.selected.length>0?t.selected.forEach(function(e){e.selected&&i.push(e[t.columnKeys.optionText])}):!t.multiple&&t.options&&t.options[0]?t.options[0].optgroup?i[0]=t.options[0].options[0][t.columnKeys.optionText]:i[0]=t.options[0][t.columnKeys.optionText]:i[0]=t.lang.noSelected,function(){if(t.multiple&&i.length>1){var e={label:i[0],length:i.length-1};return _AX6Mustache2.default.render(t.lang.multipleLabel,e)}return i[0]}()},syncLabel=function(e){this.queue[e].$displayLabel.html(getLabel.call(this,e))},focusWord=function(e,t){var i=[],n=-1,o=this.queue[e].indexedOptions.length-1,l=void 0;if(t){for(;o-n++;){if((""+(l=this.queue[e].indexedOptions[n]).value).toLowerCase()==t.toLowerCase()){i=[{"@findex":l["@findex"],optionsSort:0}];break}var s=(""+l.value).toLowerCase().search(t.toLowerCase());if(s>-1&&(i.push({"@findex":l["@findex"],optionsSort:s}),i.length>2))break;s=null}i.sort(function(e,t){return e.optionsSort-t.optionsSort})}i&&i.length>0&&focusMove.call(this,e,void 0,i[0]["@findex"]);try{return i}finally{i=null,n=null,o=null,l=null}},focusMove=function(e,t,i){var n=void 0,o=void 0,l=void 0,s=void 0;if(this.activeSelectOptionGroup&&this.queue[e].options&&this.queue[e].options.length>0){void 0!==i?n=i:-1==(o=-1==this.queue[e].optionFocusIndex?this.queue[e].optionSelectedIndex||-1:this.queue[e].optionFocusIndex)?n=t>0?0:this.queue[e].optionItemLength-1:(n=o+t)<0?n=0:n>this.queue[e].optionItemLength-1&&(n=this.queue[e].optionItemLength-1),this.queue[e].optionFocusIndex=n,this.activeSelectOptionGroup.find("[data-option-focus-index]").removeClass("hover"),l=this.activeSelectOptionGroup.find('[data-option-focus-index="'+n+'"]').addClass("hover"),s=this.activeSelectOptionGroup.find('[data-els="content"]');var a=l.outerHeight(),c=s.innerHeight(),u=s.scrollTop(),d=l.position().top+s.scrollTop();c+u<d+a?s.scrollTop(d+a-c):u>d&&s.scrollTop(d)}},bindSelectTarget=function(e){var t=this,i={click:function(e,t){_AX6Util2.default.findParentNode(t.target,function(e){if(e.getAttribute("data-selected-clear"))return!0})?this.val(e,{clear:!0}):this.activeSelectQueueIndex==e?-1==this.queue[e].optionFocusIndex&&this.close():(this.open(e),_AX6Util2.default.stopEvent(t))},keyUp:function(e,t){t.which==_AX6Info2.default.eventKeys.SPACE?i.click.call(this,e,t):ctrlKeys[t.which]||_AX6Util2.default.debounce(function(e,t){focusWord.call(this,t,e),this.queue[t].$displayInput.val("")},300).call(this,this.queue[e].$displayInput.val(),e)},keyDown:function(e,t){t.which==_AX6Info2.default.eventKeys.DOWN?(focusMove.call(this,e,1),_AX6Util2.default.stopEvent(t)):t.which==_AX6Info2.default.eventKeys.UP&&(focusMove.call(this,e,-1),_AX6Util2.default.stopEvent(t))},blur:function(e,t){},selectChange:function(e,t){this.val(e,this.queue[e].$select.val(),!0)}},n=this.queue[e],o={};return n.selected=[],n.options||(n.options=[]),n.options.forEach(function(e){e[t.config.columnKeys.optionSelected]&&n.selected.push(_jqmin2.default.extend({},e))}),n.$display?(n.$displayLabel.html(getLabel.call(this,e)),n.options=syncSelectOptions.call(this,e,n.options),alignSelectDisplay.call(this)):(o.instanceId=this.instanceId,o.id=n.id,o.name=n.name,o.theme=n.theme,o.tabIndex=n.tabIndex,o.multiple=n.multiple,o.reset=n.reset,o.label=getLabel.call(this,e),n.$display=(0,_jqmin2.default)(_AX6Mustache2.default.render(displayTmpl.call(this),o)),n.$displayLabel=n.$display.find('[data-ax6ui-select-display="label"]'),n.$target.find("select").get(0)?(n.$select=n.$target.find("select"),n.$select.attr("tabindex","-1").attr("class","form-control "+o.formSize),o.name&&n.$select.attr("name","name"),o.multiple&&n.$select.attr("multiple","multiple")):(n.$select=(0,_jqmin2.default)(_AX6Mustache2.default.render(selectTmpl.call(this),o)),n.$target.append(n.$select)),n.$target.append(n.$display),n.$displayInput=n.$display.find('[data-ax6ui-select-display="input"]'),n.options=syncSelectOptions.call(this,e,n.options),alignSelectDisplay.call(this),n.$displayInput.off("blur.ax6select").on("blur.ax6select",i.blur.bind(this,e)).off("keyup.ax6select").on("keyup.ax6select",i.keyUp.bind(this,e)).off("keydown.ax6select").on("keydown.ax6select",i.keyDown.bind(this,e))),n.$display.off("click.ax6select").on("click.ax6select",i.click.bind(this,e)).off("keyup.ax6select").on("keyup.ax6select",i.keyUp.bind(this,e)),n.$select.off("change.ax6select").on("change.ax6select",i.selectChange.bind(this,e)),o=null,n=null,e=null,this},syncSelectOptions=function(e,t){var i=this,n=function(e,t){t?this.queue[e].multiple?this.queue[e].selected.push(_jqmin2.default.extend({},t)):this.queue[e].selected[0]=_jqmin2.default.extend({},t):this.queue[e].selected=[]},o=this.queue[e],l=void 0,s=void 0,a=void 0,c=0;return n.call(this,e,!1),t?(o.options=t,o.indexedOptions=[],l=[],o.options.forEach(function(t,s){t.optgroup?(t["@gindex"]=s,t.options.forEach(function(t,s){t["@index"]=s,t["@findex"]=c,l.push('<option value="'+t[o.columnKeys.optionValue]+'" '+(t[o.columnKeys.optionSelected]?' selected="selected"':"")+">"+t[o.columnKeys.optionText]+"</option>"),t[o.columnKeys.optionSelected]&&n.call(i,e,t),o.indexedOptions.push({"@findex":c,value:t[o.columnKeys.optionValue],text:t[o.columnKeys.optionText]}),c++})):(t["@index"]=s,t["@findex"]=c,l.push('<option value="'+t[o.columnKeys.optionValue]+'" '+(t[o.columnKeys.optionSelected]?' selected="selected"':"")+">"+t[o.columnKeys.optionText]+"</option>"),t[o.columnKeys.optionSelected]&&n.call(i,e,t),o.indexedOptions.push({"@findex":c,value:t[o.columnKeys.optionValue],text:t[o.columnKeys.optionText]}),c++)}),o.optionItemLength=c,o.$select.html(l.join(""))):(s=_AX6Util2.default.toArray(o.$select.get(0).options),a=[],s.forEach(function(t,l){var s={};s[o.columnKeys.optionValue]=t.value,s[o.columnKeys.optionText]=t.text,s[o.columnKeys.optionSelected]=t.selected,s["@index"]=l,s["@findex"]=l,t.selected&&n.call(i,e,s),a.push(s),s=null}),o.options=a,o.indexedOptions=a),!o.multiple&&0==o.selected.length&&o.options&&o.options[0]&&(o.options[0].optgroup?(o.options[0].options[0][o.columnKeys.optionSelected]=!0,o.selected.push(_jqmin2.default.extend({},o.options[0].options[0]))):(o.options[0][o.columnKeys.optionSelected]=!0,o.selected.push(_jqmin2.default.extend({},o.options[0])))),l=null,s=null,a=null,o.options},getQueIdx=function(e){_AX6Util2.default.isString(e)||(e=(0,_jqmin2.default)(e).data("data-ax6ui-select-id"));{if(_AX6Util2.default.isString(e))return _AX6Util2.default.search(this.queue,function(){return this.id==e});console.log(_AX6Info2.default.getError("ax6select","402","getQueIdx"))}},ctrlKeys={18:"KEY_ALT",8:"KEY_BACKSPACE",17:"KEY_CONTROL",46:"KEY_DELETE",40:"KEY_DOWN",35:"KEY_END",187:"KEY_EQUAL",27:"KEY_ESC",36:"KEY_HOME",45:"KEY_INSERT",37:"KEY_LEFT",189:"KEY_MINUS",34:"KEY_PAGEDOWN",33:"KEY_PAGEUP",13:"KEY_RETURN",39:"KEY_RIGHT",16:"KEY_SHIFT",9:"KEY_TAB",38:"KEY_UP",91:"KEY_WINDOW"},AX6UISelect=function(e){function t(e){_classCallCheck(this,t);var i=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return i.config={theme:"default",animateTime:100,lang:{noSelected:"",noOptions:"no options",loading:"now loading..",multipleLabel:'"{{label}}"외 {{length}}건'},columnKeys:{optionValue:"value",optionText:"text",optionSelected:"selected"}},_jqmin2.default.extend(!0,i.config,e),i.queue=[],i.activeSelectOptionGroup=null,i.activeSelectQueueIndex=-1,i.openTimer=null,i.closeTimer=null,i.waitOptionsCallback=null,i.keyUpTimer=null,i.xvar={},i.init(),i}return _inherits(t,_AX6UICore3.default),_createClass(t,[{key:"init",value:function(){this.onStateChanged=this.config.onStateChanged,delete this.config.onStateChanged,this.onChange=this.config.onChange,delete this.config.onChange,this.initOnce()}},{key:"initOnce",value:function(){if(this.initialized)return this;this.initialized=!0,$window.on("resize.ax6select-display-"+this.instanceId,_AX6Util2.default.throttle(function(e){alignSelectDisplay.call(this,e||window.event),alignSelectOptionGroup.call(this)},100).bind(this))}},{key:"bind",value:function(e){var t=void 0;return(e=_jqmin2.default.extend(!0,{},this.config,e)).target?(e.$target=(0,_jqmin2.default)(e.target),e.id||(e.id=e.$target.data("data-ax6ui-select-id")),e.id||(e.id="ax6select-"+_AX6UICore3.default.getInstanceId(),e.$target.data("data-ax6ui-select-id",e.id)),e.name=e.$target.attr("data-ax6ui-select"),e.options&&(e.options=JSON.parse(JSON.stringify(e.options))),function(t){_AX6Util2.default.isObject(t)&&!t.error&&(e=_jqmin2.default.extend(!0,e,t))}(_AX6Util2.default.parseJson(e.$target.attr("data-ax6ui-select-config"),!0)),-1===(t=_AX6Util2.default.search(this.queue,function(){return this.id==e.id}))?(this.queue.push(e),bindSelectTarget.call(this,this.queue.length-1)):(this.queue[t].selected=[],this.queue[t].options=e.options,this.queue[t]=_jqmin2.default.extend(!0,{},this.queue[t],e),bindSelectTarget.call(this,t)),t=null,this):(console.log(_AX6Info2.default.getError("ax6select","401","bind")),this)}},{key:"open",value:function(e,t){this.waitOptionsCallback=null;var i=_AX6Util2.default.isNumber(e)?e:getQueIdx.call(this,e),n=this.queue[i],o={},l=void 0,s=void 0;return n.$display.attr("disabled")?this:(this.openTimer&&clearTimeout(this.openTimer),this.activeSelectOptionGroup?this.activeSelectQueueIndex==i?this:t>2?this:(this.close(),this.openTimer=setTimeout(function(){this.open(i,(t||0)+1)}.bind(this),this.config.animateTime),this):(n.optionFocusIndex=-1,n.selected&&n.selected.length>0&&(n.optionSelectedIndex=n.selected[0]["@findex"]),o.id=n.id,o.theme=n.theme,o.size="ax6select-option-group-"+n.size,o.multiple=n.multiple,o.lang=n.lang,n.$display.attr("data-select-option-group-opened","true"),n.onExpand&&(o.waitOptions=!0),o.options=n.options,this.activeSelectOptionGroup=(0,_jqmin2.default)(_AX6Mustache2.default.render(optionGroupTmpl.call(this),o)),this.activeSelectOptionGroup.find('[data-els="content"]').html(_AX6Mustache2.default.render(optionsTmpl.call(this,n.columnKeys),o)),this.activeSelectQueueIndex=i,alignSelectOptionGroup.call(this,"append"),n.selected&&n.selected.length>0&&(s=this.activeSelectOptionGroup.find('[data-option-index="'+n.selected[0]["@index"]+'"]')).get(0)&&(l=s.position().top-this.activeSelectOptionGroup.height()/3,this.activeSelectOptionGroup.find('[data-els="content"]').scrollTop(l)),n.$displayInput.val(""),setTimeout(function(){n.$displayInput.trigger("focus"),(0,_jqmin2.default)(window).on("keyup.ax6select-"+this.instanceId,function(e){e=e||window.event,onBodyKeyup.call(this,e),_AX6Util2.default.stopEvent(e)}.bind(this)),(0,_jqmin2.default)(window).on("click.ax6select-"+this.instanceId,function(e){e=e||window.event,onBodyClick.call(this,e),_AX6Util2.default.stopEvent(e)}.bind(this))}.bind(this),300),onStateChanged.call(this,n,{self:this,state:"open",item:n}),n.onExpand&&(this.waitOptionsCallback=!0,function(e){var t=this;e.onExpand.call({self:this,item:e},function(e){if(t.waitOptionsCallback){var i={},n=t.queue[t.activeSelectQueueIndex];!function(e,t){var i={};t.options.forEach(function(t,n){t["@index"]=n,i[t[e.columnKeys.optionValue]]=t}),_AX6Util2.default.isArray(e.selected)&&e.selected.forEach(function(n){i[n[e.columnKeys.optionValue]]&&(t.options[i[n[e.columnKeys.optionValue]]["@index"]][e.columnKeys.optionSelected]=!0)})}(n,e),n.$displayLabel.html(getLabel.call(t,t.activeSelectQueueIndex)),n.options=syncSelectOptions.call(t,t.activeSelectQueueIndex,e.options),alignSelectDisplay.call(t),i.id=n.id,i.theme=n.theme,i.size="ax6select-option-group-"+n.size,i.multiple=n.multiple,i.lang=n.lang,i.options=n.options,t.activeSelectOptionGroup.find('[data-els="content"]').html(_AX6Mustache2.default.render(optionsTmpl.call(t,n.columnKeys),i))}})}.call(this,n)),o=null,l=null,s=null,this))}},{key:"update",value:function(e){return this.bind(e),this}},{key:"setOptions",value:function(e,t){var i=getQueIdx.call(this,e);return this.queue[i].selected=[],this.queue[i].options=t,bindSelectTarget.call(this,i),this}},{key:"val",value:function(e,t,i,n){var o=function(e,t,i){return void 0===i?!e.multiple||!t:i},l=function(e){this.queue[e].options.forEach(function(e){e.optgroup?e.options.forEach(function(e){e.selected=!1}):e.selected=!1})},s={index:function(e,t,i){var n=this.queue[e];_AX6Util2.default.isString(t.index.gindex)?(n.options[t.index.gindex].options[t.index.index][n.columnKeys.optionSelected]=o(n,n.options[t.index.gindex].options[t.index.index][n.columnKeys.optionSelected],i),this.activeSelectOptionGroup.find('[data-option-group-index="'+t.index.gindex+'"][data-option-index="'+t.index.index+'"]').attr("data-option-selected",n.options[t.index.gindex].options[t.index.index][n.columnKeys.optionSelected].toString())):(n.options[t.index.index][n.columnKeys.optionSelected]=o(n,n.options[t.index.index][n.columnKeys.optionSelected],i),this.activeSelectOptionGroup.find('[data-option-index="'+t.index.index+'"]').attr("data-option-selected",n.options[t.index.index][n.columnKeys.optionSelected].toString())),syncSelectOptions.call(this,e,n.options),syncLabel.call(this,e),alignSelectOptionGroup.call(this)},arr:function(e,t,i){var n=this;t.forEach(function(t){if(_AX6Util2.default.isString(t)||_AX6Util2.default.isNumber(t))s.value.call(n,e,t,i);else for(var o in s)if(t[o]){s[o].call(n,e,t,i);break}})},value:function(e,t,i){var n=this.queue[e],l=_AX6Util2.default.search(n.options,function(){return this[n.columnKeys.optionValue]==t});l>-1?(n.options[l][n.columnKeys.optionSelected]=o(n,n.options[l][n.columnKeys.optionSelected],i),syncSelectOptions.call(this,e,n.options),syncLabel.call(this,e)):console.log(_AX6Info2.default.getError("ax6select","501","val"))},text:function(e,t,i){var n=this.queue[e],l=_AX6Util2.default.search(n.options,function(){return this[n.columnKeys.optionText]==t});l>-1?(n.options[l][n.columnKeys.optionSelected]=o(n,n.options[l][n.columnKeys.optionSelected],i),syncSelectOptions.call(this,e,n.options),syncLabel.call(this,e)):console.log(_AX6Info2.default.getError("ax6select","501","val"))},clear:function(e){l.call(this,e),syncSelectOptions.call(this,e,this.queue[e].options),syncLabel.call(this,e),this.activeSelectOptionGroup&&this.activeSelectOptionGroup.find("[data-option-index]").attr("data-option-selected","false")}},a=_AX6Util2.default.isNumber(e)?e:getQueIdx.call(this,e);if(!this.queue[a])return this;if(void 0===t||this.queue[a].multiple||l.call(this,a),void 0===t)return this.queue[a].selected;if(_AX6Util2.default.isArray(t))s.arr.call(this,a,t,i);else if(_AX6Util2.default.isString(t)||_AX6Util2.default.isNumber(t))s.value.call(this,a,t,i);else if(null===t)s.clear.call(this,a);else for(var c in s)if(t[c]){s[c].call(this,a,t,i);break}return void 0!==t&&onStateChanged.call(this,this.queue[a],{self:this,item:this.queue[a],state:n?"changeValue":"setValue",value:this.queue[a].selected,internal:n}),e=null,this}},{key:"close",value:function(e){var t=this;return this.closeTimer&&clearTimeout(this.closeTimer),this.activeSelectOptionGroup?(e=this.queue[this.activeSelectQueueIndex],e.optionFocusIndex=-1,e.$displayInput.val("").trigger("blur"),e.$display.removeAttr("data-select-option-group-opened").trigger("focus"),this.activeSelectOptionGroup.addClass("destroy"),(0,_jqmin2.default)(window).off("resize.ax6select-"+this.instanceId).off("click.ax6select-"+this.instanceId).off("keyup.ax6select-"+this.instanceId),this.closeTimer=setTimeout(function(){t.activeSelectOptionGroup&&t.activeSelectOptionGroup.remove(),t.activeSelectOptionGroup=null,t.activeSelectQueueIndex=-1;var i={self:t,item:e,value:e.selected,state:"close"};onStateChanged.call(t,e,i),e.onClose&&e.onClose.call(i)},this.config.animateTime),this.waitOptionsCallback=null,this):this}},{key:"enable",value:function(e){var t=getQueIdx.call(this,e);return this.queue[t].$display.removeAttr("disabled"),this.queue[t].$select.removeAttr("disabled"),onStateChanged.call(this,this.queue[t],{self:this,state:"enable"}),this}},{key:"disable",value:function(e){var t=getQueIdx.call(this,e);return this.queue[t].$display.attr("disabled","disabled"),this.queue[t].$select.attr("disabled","disabled"),onStateChanged.call(this,this.queue[t],{self:this,state:"disable"}),this}}]),t}();exports.default=AX6UISelect;
//# sourceMappingURL=AX6UISelect.js.map
