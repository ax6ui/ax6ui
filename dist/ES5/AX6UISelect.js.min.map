{"version":3,"sources":["AX6UISelect.js"],"names":["_jqmin","require","_AX6UICore2","_AX6Info","_AX6Util","_AX6Mustache","$window","_jqmin2","default","window","displayTmpl","columnKeys","selectTmpl","optionsTmpl","alignSelectDisplay","length","optionSelected","optionText","optionValue","winWidth","width","that","winHeight","Math","activeSelectOptionGroup","this","onStateChanged","call","state","pickerDirection","item","onChange","top","dim","height","i","queue","w","pos","pickerDim","positionMargin","$display","css","min-width","newTop","reset","find","line-height","alignSelectOptionGroup","append","left","document","$target","offset","outerWidth","outerHeight","max","body","activeSelectQueueIndex","clickEl","direction","gindex","index","addClass","close","onBodyKeyup","$option","undefined","labels","onBodyClick","isArray","selected","target","optgroup","getAttribute","options","get","val","id","syncLabel","trigger","queIdx","multiple","label","value","toLowerCase","_AX6Info2","eventKeys","ESC","e","sort","optionFocusIndex","push","optionsSort","attr","$select","getLabel","l","forEach","n","_focusIndex","_prevFocusIndex","focusOptionEl","lang","noSelected","data","render","multipleLabel","focusOptionElHeight","html","optionGroupScrollContainerHeight","focusWord","focusOptionElTop","indexedOptions","searchWord","optionGroupScrollContainer","optionGroupScrollContainerScrollTop","@findex","search","bindSelectTarget","a","b","focusMove","findex","selectEvent","optionSelectedIndex","optionItemLength","stopEvent","innerHeight","scrollTop","position","tabIndex","_this","$displayLabel","_AX6Util2","findParentNode","clear","open","which","SPACE","$displayInput","on","debounce","keyDown","DOWN","UP","blur","selectChange","po","elementOptions","newOptions","focusIndex","extend","option","OIndex","instanceId","name","theme","O","OO","OOIndex","setSelected","_AX6Mustache2","off","bind","keyUp","click","syncSelectOptions","_this2","isString","boundID","getQueIdx","ctrlKeys","text","AX6UISelect","config","toArray","noOptions","loading","console","log","getError","18","8","17","46","40","35","187","27","36","45","37","189","34","33","13","39","16","9","38","91","_classCallCheck","_this3","_possibleConstructorReturn","__proto__","Object","getPrototypeOf","animateTime","closeTimer","waitOptionsCallback","keyUpTimer","xvar","init","initOnce","initialized","throttle","_OIndex","_O","optionsMap","JSON","parse","stringify","isObject","error","isNumber","parseJson","openTimer","selectedOptionEl","tryCount","setTimeout","_this5","clearTimeout","onExpand","focusTop","size","_item","waitOptions","optionGroupTmpl","nn","self","processor","_this4","event","optionIndex","getSelected","o","clearSelected","toString","arr","_this6","values","key","internal","_this7","removeAttr","remove","onClose"],"mappings":"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","file":"AX6UISelect.js","sourcesContent":["import jQuery from \"jqmin\";\nimport AX6UICore from \"./AX6UICore.js\";\nimport info from \"./AX6Info\";\nimport U from \"./AX6Util\";\nimport mustache from \"./AX6Mustache\";\nimport \"./AX6UISelect/index.scss\";\n\nconst $window = jQuery(window);\nconst displayTmpl = function (columnKeys) {\n  return `\n<a {{^tabIndex}}href=\"#ax6select-{{id}}\" {{/tabIndex}}{{#tabIndex}}tabindex=\"{{tabIndex}}\" {{/tabIndex}}class=\"ax6select-display {{theme}}\" \ndata-ax6ui-select-display=\"{{id}}\" data-ax6ui-select-instance=\"{{instanceId}}\" style=\"height: {{height}}px;\">\n    <div class=\"ax6select-display-table\" data-els=\"display-table\">\n        <div data-ax6ui-select-display=\"label\">{{label}}</div>\n        <div data-ax6ui-select-display=\"addon\"> \n            {{#multiple}}{{#reset}}\n            <span class=\"addon-icon-reset\" data-selected-clear=\"true\">{{{.}}}</span>\n            {{/reset}}{{/multiple}}\n            {{#icons}}\n            <span class=\"addon-icon-closed\">{{clesed}}</span>\n            <span class=\"addon-icon-opened\">{{opened}}</span>\n            {{/icons}}\n            {{^icons}}\n            <span class=\"addon-icon-closed\"><span class=\"addon-icon-arrow\"></span></span>\n            <span class=\"addon-icon-opened\"><span class=\"addon-icon-arrow\"></span></span>\n            {{/icons}}\n        </div>\n    </div>\n    <input type=\"text\" tabindex=\"-1\" data-ax6ui-select-display=\"input\" \n    style=\"position:absolute;z-index:0;left:0px;top:0px;font-size:1px;opacity: 0;width:1px;height:1px;border: 0 none;color : transparent;text-indent: -9999em;\" />\n</a>\n`;\n};\nconst selectTmpl = function (columnKeys) {\n  return `\n<select tabindex=\"-1\" class=\"\" name=\"{{name}}\" {{#multiple}}multiple=\"multiple\"{{/multiple}} style=\"height: {{height}}px;\"></select>\n`;\n};\nconst optionGroupTmpl = function (columnKeys) {\n  return `\n<div class=\"ax6select-option-group {{theme}}\" data-ax6ui-select-option-group=\"{{id}}\">\n    <div class=\"ax-select-body\">\n        <div class=\"ax-select-option-group-content\" data-els=\"content\"></div>\n    </div>\n    <div class=\"ax-select-arrow\"></div> \n</div>\n`;\n};\nconst optionsTmpl = function (columnKeys) {\n  return `\n{{#waitOptions}}\n    <div class=\"ax-select-option-item\">\n            <div class=\"ax-select-option-item-holder\">\n                <span class=\"ax-select-option-item-cell ax-select-option-item-label\">\n                    {{{lang.loading}}}\n                </span>\n            </div>\n        </div>\n{{/waitOptions}}\n{{^waitOptions}}\n    {{#options}}\n        {{#optgroup}}\n            <div class=\"ax-select-option-group\">\n                <div class=\"ax-select-option-item-holder\">\n                    <span class=\"ax-select-option-group-label\">\n                        {{{.}}}\n                    </span>\n                </div>\n                {{#options}}\n                <div class=\"ax-select-option-item\" data-option-focus-index=\"{{@findex}}\" data-option-group-index=\"{{@gindex}}\" data-option-index=\"{{@index}}\" \n                data-option-value=\"{{${columnKeys.optionValue}}}\" \n                {{#${columnKeys.optionSelected}}}data-option-selected=\"true\"{{/${columnKeys.optionSelected}}}>\n                    <div class=\"ax-select-option-item-holder\">\n                        {{#multiple}}\n                        <span class=\"ax-select-option-item-cell ax-select-option-item-checkbox\">\n                            <span class=\"item-checkbox-wrap useCheckBox\" data-option-checkbox-index=\"{{@i}}\"></span>\n                        </span>\n                        {{/multiple}}\n                        <span class=\"ax-select-option-item-cell ax-select-option-item-label\">{{{${columnKeys.optionText}}}}</span>\n                    </div>\n                </div>\n                {{/options}}\n            </div>                            \n        {{/optgroup}}\n        {{^optgroup}}\n        <div class=\"ax-select-option-item\" data-option-focus-index=\"{{@findex}}\" data-option-index=\"{{@index}}\" data-option-value=\"{{${columnKeys.optionValue}}}\" {{#${columnKeys.optionSelected}}}data-option-selected=\"true\"{{/${columnKeys.optionSelected}}}>\n            <div class=\"ax-select-option-item-holder\">\n                {{#multiple}}\n                <span class=\"ax-select-option-item-cell ax-select-option-item-checkbox\">\n                    <span class=\"item-checkbox-wrap useCheckBox\" data-option-checkbox-index=\"{{@i}}\"></span>\n                </span>\n                {{/multiple}}\n                <span class=\"ax-select-option-item-cell ax-select-option-item-label\">{{{${columnKeys.optionText}}}}</span>\n            </div>\n        </div>\n        {{/optgroup}}\n    {{/options}}\n    {{^options}}\n        <div class=\"ax-select-option-item\">\n            <div class=\"ax-select-option-item-holder\">\n                <span class=\"ax-select-option-item-cell ax-select-option-item-label\">\n                    {{{lang.noOptions}}}\n                </span>\n            </div>\n        </div>\n    {{/options}}\n{{/waitOptions}}\n`;\n};\nconst onStateChanged = function (item, that) {\n  if (item && item.onStateChanged) {\n    item.onStateChanged.call(that, that);\n  }\n  else if (this.onStateChanged) {\n    this.onStateChanged.call(that, that);\n  }\n\n  if (that.state == \"changeValue\") {\n    if (item && item.onChange) {\n      item.onChange.call(that, that);\n    }\n    else if (this.onChange) {\n      this.onChange.call(that, that);\n    }\n  }\n\n  item = null;\n  that = null;\n  return true;\n};\nconst alignSelectDisplay = function () {\n  let i = this.queue.length, w;\n  while (i--) {\n    if (this.queue[i].$display) {\n      w = Math.max(this.queue[i].$select.outerWidth(), U.number(this.queue[i].minWidth));\n      this.queue[i].$display.css({\n        \"min-width\": w\n      });\n      if (this.queue[i].reset) {\n        this.queue[i].$display.find(\".addon-icon-reset\").css({\n          \"line-height\": this.queue[i].$display.height() + \"px\"\n        });\n      }\n    }\n  }\n\n  i = null;\n  w = null;\n  return this;\n};\nconst alignSelectOptionGroup = function (append) {\n  if (!this.activeSelectOptionGroup) return this;\n\n  let item = this.queue[this.activeSelectQueueIndex],\n    pos = {}, positionMargin = 0,\n    dim = {}, pickerDim = {},\n    pickerDirection;\n\n  if (append) jQuery(document.body).append(this.activeSelectOptionGroup);\n\n  pos = item.$target.offset();\n  dim = {\n    width: item.$target.outerWidth(),\n    height: item.$target.outerHeight()\n  };\n  pickerDim = {\n    winWidth: Math.max($window.width(), jQuery(document.body).width()),\n    winHeight: Math.max($window.height(), jQuery(document.body).height()),\n    width: this.activeSelectOptionGroup.outerWidth(),\n    height: this.activeSelectOptionGroup.outerHeight()\n  };\n\n  // picker css(width, left, top) & direction 결정\n  if (!item.direction || item.direction === \"\" || item.direction === \"auto\") {\n    // set direction\n    pickerDirection = \"top\";\n\n    if (pos.top - pickerDim.height - positionMargin < 0) {\n      pickerDirection = \"top\";\n    } else if (pos.top + dim.height + pickerDim.height + positionMargin > pickerDim.winHeight) {\n      pickerDirection = \"bottom\";\n    }\n  } else {\n    pickerDirection = item.direction;\n  }\n  // todo : 표현할 공간이 없다면..\n  if (append) {\n    this.activeSelectOptionGroup\n      .addClass(\"direction-\" + pickerDirection);\n  }\n  this.activeSelectOptionGroup\n    .css((function () {\n      if (pickerDirection == \"top\") {\n        if (pos.top + dim.height + pickerDim.height + positionMargin > pickerDim.winHeight) {\n\n          var newTop = pos.top + dim.height / 2 - pickerDim.height / 2;\n          if (newTop + pickerDim.height + positionMargin > pickerDim.winHeight) {\n            newTop = 0;\n          }\n          if (newTop < 0) {\n            newTop = 0;\n          }\n\n          return {\n            left: pos.left,\n            top: newTop,\n            width: dim.width\n          }\n        }\n        return {\n          left: pos.left,\n          top: pos.top + dim.height + 1,\n          width: dim.width\n        }\n      }\n      else if (pickerDirection == \"bottom\") {\n        return {\n          left: pos.left,\n          top: pos.top - pickerDim.height - 1,\n          width: dim.width\n        }\n      }\n    }).call(this));\n};\nconst onBodyClick = function (e, target) {\n  if (!this.activeSelectOptionGroup) return this;\n\n  let item = this.queue[this.activeSelectQueueIndex],\n    clickEl = \"display\";\n\n  target = U.findParentNode(e.target, function (target) {\n    if (target.getAttribute(\"data-option-value\") || target.getAttribute(\"data-option-value\") == \"\") {\n      clickEl = \"optionItem\";\n      return true;\n    }\n    else if (item.$target.get(0) == target) {\n      clickEl = \"display\";\n      return true;\n    }\n  });\n\n  if (!target) {\n    this.close();\n    return this;\n  }\n  else if (clickEl === \"optionItem\") {\n    this.val(item.id, {\n      index: {\n        gindex: target.getAttribute(\"data-option-group-index\"),\n        index: target.getAttribute(\"data-option-index\")\n      }\n    }, undefined, \"internal\");\n    item.$select.trigger(\"change\");\n    item.$display.focus();\n    if (!item.multiple) this.close();\n  }\n  else {\n    //open and display click\n    //console.log(this.instanceId);\n  }\n\n  return this;\n};\nconst onBodyKeyup = function (e) {\n  if (e.keyCode == info.eventKeys.ESC) {\n    this.close();\n  }\n  else if (e.which == info.eventKeys.RETURN) {\n    if (this.queue[this.activeSelectQueueIndex].optionFocusIndex > -1) { // 아이템에 포커스가 활성화 된 후, 마우스 이벤트 이면 무시\n      let $option = this.activeSelectOptionGroup.find('[data-option-focus-index=\"' + this.queue[this.activeSelectQueueIndex].optionFocusIndex + '\"]');\n      this.val(this.queue[this.activeSelectQueueIndex].id, {\n        index: {\n          gindex: $option.attr(\"data-option-group-index\"),\n          index: $option.attr(\"data-option-index\")\n        }\n      }, undefined, \"internal\");\n      this.queue[this.activeSelectQueueIndex].$select.trigger(\"change\");\n      if (!this.queue[this.activeSelectQueueIndex].multiple) this.close();\n    } else {\n      this.close();\n    }\n  }\n};\nconst getLabel = function (queIdx) {\n  let item = this.queue[queIdx],\n    labels = [];\n\n  if (U.isArray(item.selected) && item.selected.length > 0) {\n    item.selected.forEach(function (n) {\n      if (n.selected) labels.push(n[item.columnKeys.optionText]);\n    });\n  }\n  else {\n    if (!item.multiple && item.options && item.options[0]) {\n      if (item.options[0].optgroup) {\n        labels[0] = item.options[0].options[0][item.columnKeys.optionText];\n      }\n      else {\n        labels[0] = item.options[0][item.columnKeys.optionText];\n      }\n    }\n    else {\n      labels[0] = item.lang.noSelected;\n    }\n  }\n\n  return (function () {\n    if (item.multiple && labels.length > 1) {\n      let data = {\n        label: labels[0],\n        length: labels.length - 1\n      };\n      return mustache.render(item.lang.multipleLabel, data);\n    }\n    else {\n      return labels[0];\n    }\n  })();\n};\nconst syncLabel = function (queIdx) {\n  this.queue[queIdx].$displayLabel\n    .html(getLabel.call(this, queIdx));\n};\nconst focusWord = function (queIdx, searchWord) {\n  let options = [], i = -1, l = this.queue[queIdx].indexedOptions.length - 1, n;\n  if (searchWord) {\n    while (l - i++) {\n      n = this.queue[queIdx].indexedOptions[i];\n      if (('' + n.value).toLowerCase() == searchWord.toLowerCase()) {\n        options = [{'@findex': n['@findex'], optionsSort: 0}];\n        break;\n      } else {\n        let sort = ('' + n.value).toLowerCase().search(searchWord.toLowerCase());\n        if (sort > -1) {\n          options.push({'@findex': n['@findex'], optionsSort: sort});\n          if (options.length > 2) break;\n        }\n        sort = null;\n      }\n    }\n    options.sort(function (a, b) {\n      return a.optionsSort - b.optionsSort;\n    });\n  }\n  if (options && options.length > 0) {\n    focusMove.call(this, queIdx, undefined, options[0]['@findex']);\n  }\n\n  try {\n    return options;\n  }\n  finally {\n    options = null;\n    i = null;\n    l = null;\n    n = null;\n  }\n};\nconst focusMove = function (queIdx, direction, findex) {\n  let _focusIndex,\n    _prevFocusIndex,\n    focusOptionEl,\n    optionGroupScrollContainer;\n\n  if (this.activeSelectOptionGroup && this.queue[queIdx].options && this.queue[queIdx].options.length > 0) {\n\n    if (typeof findex !== \"undefined\") {\n      _focusIndex = findex\n    }\n    else {\n      _prevFocusIndex = (this.queue[queIdx].optionFocusIndex == -1) ? this.queue[queIdx].optionSelectedIndex || -1 : this.queue[queIdx].optionFocusIndex;\n      if (_prevFocusIndex == -1) {\n        _focusIndex = (direction > 0) ? 0 : this.queue[queIdx].optionItemLength - 1;\n      }\n      else {\n        _focusIndex = _prevFocusIndex + direction;\n        if (_focusIndex < 0) _focusIndex = 0;\n        else if (_focusIndex > this.queue[queIdx].optionItemLength - 1) _focusIndex = this.queue[queIdx].optionItemLength - 1;\n      }\n    }\n\n    this.queue[queIdx].optionFocusIndex = _focusIndex;\n\n    this.activeSelectOptionGroup\n      .find('[data-option-focus-index]')\n      .removeClass(\"hover\");\n\n    focusOptionEl = this.activeSelectOptionGroup\n      .find('[data-option-focus-index=\"' + _focusIndex + '\"]')\n      .addClass(\"hover\");\n\n    optionGroupScrollContainer = this.activeSelectOptionGroup.find('[data-els=\"content\"]');\n\n    let focusOptionElHeight = focusOptionEl.outerHeight(),\n      optionGroupScrollContainerHeight = optionGroupScrollContainer.innerHeight(),\n      optionGroupScrollContainerScrollTop = optionGroupScrollContainer.scrollTop(),\n      focusOptionElTop = focusOptionEl.position().top + optionGroupScrollContainer.scrollTop();\n\n    if (optionGroupScrollContainerHeight + optionGroupScrollContainerScrollTop < focusOptionElTop + focusOptionElHeight) {\n      optionGroupScrollContainer.scrollTop(focusOptionElTop + focusOptionElHeight - optionGroupScrollContainerHeight);\n    }\n    else if (optionGroupScrollContainerScrollTop > focusOptionElTop) {\n      optionGroupScrollContainer.scrollTop(focusOptionElTop);\n    }\n    // optionGroup scroll check\n  }\n};\nconst bindSelectTarget = function (queIdx) {\n  const selectEvent = {\n    'click': function (queIdx, e) {\n      let target = U.findParentNode(e.target, function (target) {\n        if (target.getAttribute(\"data-selected-clear\")) {\n          //clickEl = \"clear\";\n          return true;\n        }\n      });\n\n      if (target) {\n        this.val(queIdx, {clear: true});\n      }\n      else {\n        if (this.activeSelectQueueIndex == queIdx) {\n          if (this.queue[queIdx].optionFocusIndex == -1) { // 아이템에 포커스가 활성화 된 후, 마우스 이벤트 이면 무시\n            this.close();\n          }\n        }\n        else {\n          this.open(queIdx);\n          U.stopEvent(e);\n        }\n      }\n    },\n    'keyUp': function (queIdx, e) {\n      if (e.which == info.eventKeys.SPACE) {\n        selectEvent.click.call(this, queIdx, e);\n      }\n      else if (!ctrlKeys[e.which]) {\n        // 사용자 입력이 뜸해지면 찾고 검색 값 제거...\n        U.debounce(function (searchWord, queIdx) {\n          focusWord.call(this, queIdx, searchWord);\n          this.queue[queIdx].$displayInput.val('');\n        }, 300).call(this, this.queue[queIdx].$displayInput.val(), queIdx);\n      }\n    },\n    'keyDown': function (queIdx, e) {\n      if (e.which == info.eventKeys.DOWN) {\n        focusMove.call(this, queIdx, 1);\n        U.stopEvent(e);\n      }\n      else if (e.which == info.eventKeys.UP) {\n        focusMove.call(this, queIdx, -1);\n        U.stopEvent(e);\n      }\n    },\n    'blur': function (queIdx, e) {\n\n    },\n    'selectChange': function (queIdx, e) {\n      this.val(queIdx, this.queue[queIdx].$select.val(), true);\n    }\n  };\n\n  let item = this.queue[queIdx], data = {};\n\n  // find selected\n  item.selected = [];\n  if (!item.options) item.options = [];\n  item.options.forEach((n) => {\n    if (n[this.config.columnKeys.optionSelected]) item.selected.push(jQuery.extend({}, n));\n  });\n\n  if (!item.$display) {\n    /// 템플릿에 전달할 오브젝트 선언\n    data.instanceId = this.instanceId;\n    data.id = item.id;\n    data.name = item.name;\n    data.theme = item.theme;\n    data.tabIndex = item.tabIndex;\n    data.multiple = item.multiple;\n    data.reset = item.reset;\n    data.height = item.height;\n    data.label = getLabel.call(this, queIdx);\n\n    item.$display = jQuery(mustache.render(displayTmpl.call(this), data));\n    //item.$display.css({height: item.height});\n    item.$displayLabel = item.$display.find('[data-ax6ui-select-display=\"label\"]');\n\n    if (item.$target.find(\"select\").get(0)) {\n      item.$select = item.$target.find(\"select\");\n      // select 속성만 변경\n      item.$select\n        .attr(\"tabindex\", \"-1\")\n        .css({height: data.height});\n\n      if (data.name) {\n        item.$select.attr(\"name\", \"name\");\n      }\n      if (data.multiple) {\n        item.$select.attr(\"multiple\", \"multiple\");\n      }\n    }\n    else {\n      item.$select = jQuery(mustache.render(selectTmpl.call(this), data));\n      item.$target.append(item.$select);\n      // select append\n    }\n\n    item.$target.append(item.$display);\n    item.$displayInput = item.$display.find('[data-ax6ui-select-display=\"input\"]'); // 사용자 입력값을 받기위한 숨음 입력필드\n    item.options = syncSelectOptions.call(this, queIdx, item.options);\n\n    alignSelectDisplay.call(this);\n\n    item.$displayInput\n      .off(\"blur.ax6select\")\n      .on(\"blur.ax6select\", selectEvent.blur.bind(this, queIdx))\n      .off('keyup.ax6select')\n      .on('keyup.ax6select', selectEvent.keyUp.bind(this, queIdx))\n      .off(\"keydown.ax6select\")\n      .on(\"keydown.ax6select\", selectEvent.keyDown.bind(this, queIdx));\n  }\n  else {\n    item.$displayLabel\n      .html(getLabel.call(this, queIdx));\n    item.options = syncSelectOptions.call(this, queIdx, item.options);\n\n    alignSelectDisplay.call(this);\n  }\n\n  item.$display\n    .off('click.ax6select')\n    .on('click.ax6select', selectEvent.click.bind(this, queIdx))\n    .off('keyup.ax6select')\n    .on('keyup.ax6select', selectEvent.keyUp.bind(this, queIdx));\n\n  // select 태그에 대한 change 이벤트 감시\n  item.$select\n    .off('change.ax6select')\n    .on('change.ax6select', selectEvent.selectChange.bind(this, queIdx));\n\n  data = null;\n  item = null;\n  queIdx = null;\n  return this;\n};\n\nconst syncSelectOptions = function (queIdx, options) {\n  const setSelected = function (queIdx, O) {\n    if (!O) {\n      this.queue[queIdx].selected = [];\n    }\n    else {\n      if (this.queue[queIdx].multiple) this.queue[queIdx].selected.push(jQuery.extend({}, O));\n      else this.queue[queIdx].selected[0] = jQuery.extend({}, O);\n    }\n  };\n\n  let item = this.queue[queIdx],\n    po, elementOptions, newOptions, focusIndex = 0;\n\n  setSelected.call(this, queIdx, false); // item.selected 초기화\n\n  if (options) {\n    item.options = options;\n    item.indexedOptions = [];\n\n    // select options 태그 생성\n    po = [];\n    item.options.forEach((O, OIndex) => {\n      if (O.optgroup) {\n\n        O['@gindex'] = OIndex;\n        O.options.forEach((OO, OOIndex) => {\n          OO['@index'] = OOIndex;\n          OO['@findex'] = focusIndex;\n          po.push('<option value=\"' + OO[item.columnKeys.optionValue] + '\" '\n            + (OO[item.columnKeys.optionSelected] ? ' selected=\"selected\"' : '') + '>'\n            + OO[item.columnKeys.optionText] + '</option>');\n          if (OO[item.columnKeys.optionSelected]) {\n            setSelected.call(this, queIdx, OO);\n          }\n\n          item.indexedOptions.push({\n            '@findex': focusIndex, value: OO[item.columnKeys.optionValue], text: OO[item.columnKeys.optionText]\n          });\n          focusIndex++;\n        });\n      }\n      else {\n        O['@index'] = OIndex;\n        O['@findex'] = focusIndex;\n        po.push('<option value=\"' + O[item.columnKeys.optionValue] + '\" '\n          + (O[item.columnKeys.optionSelected] ? ' selected=\"selected\"' : '') + '>'\n          + O[item.columnKeys.optionText] + '</option>');\n        if (O[item.columnKeys.optionSelected]) {\n          setSelected.call(this, queIdx, O);\n        }\n\n        item.indexedOptions.push({\n          '@findex': focusIndex, value: O[item.columnKeys.optionValue], text: O[item.columnKeys.optionText]\n        });\n        focusIndex++;\n      }\n    });\n    item.optionItemLength = focusIndex;\n    item.$select.html(po.join(''));\n  }\n  else {\n    /// select > options 태그로 스크립트 options를 만들어주는 역할\n    elementOptions = U.toArray(item.$select.get(0).options);\n    // select option 스크립트 생성\n    newOptions = [];\n    elementOptions.forEach((O, OIndex) => {\n      let option = {};\n\n      option[item.columnKeys.optionValue] = O.value;\n      option[item.columnKeys.optionText] = O.text;\n      option[item.columnKeys.optionSelected] = O.selected;\n      option['@index'] = OIndex;\n      option['@findex'] = OIndex;\n      if (O.selected) setSelected.call(this, queIdx, option);\n      newOptions.push(option);\n\n      option = null;\n    });\n    item.options = newOptions;\n    item.indexedOptions = newOptions;\n  }\n\n  if (!item.multiple && item.selected.length == 0 && item.options && item.options[0]) {\n    if (item.options[0].optgroup) {\n      item.options[0].options[0][item.columnKeys.optionSelected] = true;\n      item.selected.push(jQuery.extend({}, item.options[0].options[0]));\n    }\n    else {\n      item.options[0][item.columnKeys.optionSelected] = true;\n      item.selected.push(jQuery.extend({}, item.options[0]));\n    }\n  }\n\n  po = null;\n  elementOptions = null;\n  newOptions = null;\n  return item.options;\n};\n\nconst getQueIdx = function (boundID) {\n  if (!U.isString(boundID)) {\n    boundID = jQuery(boundID).data(\"data-ax6ui-select-id\");\n  }\n  if (!U.isString(boundID)) {\n    console.log(info.getError(\"ax6select\", \"402\", \"getQueIdx\"));\n    return;\n  }\n  return U.search(this.queue, function () {\n    return this.id == boundID;\n  });\n};\n\nlet ctrlKeys = {\n  \"18\": \"KEY_ALT\",\n  \"8\": \"KEY_BACKSPACE\",\n  \"17\": \"KEY_CONTROL\",\n  \"46\": \"KEY_DELETE\",\n  \"40\": \"KEY_DOWN\",\n  \"35\": \"KEY_END\",\n  \"187\": \"KEY_EQUAL\",\n  \"27\": \"KEY_ESC\",\n  \"36\": \"KEY_HOME\",\n  \"45\": \"KEY_INSERT\",\n  \"37\": \"KEY_LEFT\",\n  \"189\": \"KEY_MINUS\",\n  \"34\": \"KEY_PAGEDOWN\",\n  \"33\": \"KEY_PAGEUP\",\n  // \"190\": \"KEY_PERIOD\",\n  \"13\": \"KEY_RETURN\",\n  \"39\": \"KEY_RIGHT\",\n  \"16\": \"KEY_SHIFT\",\n  // \"32\": \"KEY_SPACE\",\n  \"9\": \"KEY_TAB\",\n  \"38\": \"KEY_UP\",\n  \"91\": \"KEY_WINDOW\"\n  //\"107\" : \"NUMPAD_ADD\",\n  //\"194\" : \"NUMPAD_COMMA\",\n  //\"110\" : \"NUMPAD_DECIMAL\",\n  //\"111\" : \"NUMPAD_DIVIDE\",\n  //\"12\" : \"NUMPAD_EQUAL\",\n  //\"106\" : \"NUMPAD_MULTIPLY\",\n  //\"109\" : \"NUMPAD_SUBTRACT\"\n};\n\n\n/**\n * @class\n */\nclass AX6UISelect extends AX6UICore {\n  /**\n   * @constructor\n   * @param config\n   */\n  constructor(config) {\n    super();\n\n    /**\n     * @member {JSON}\n     * @param config\n     * @param [config.theme='default']\n     * @param [config.animateTime=100]\n     * @param [config.lang] - 메세지들\n     * @param [config.lang.noSelected='']\n     * @param [config.lang.noOptions='no options']\n     * @param [config.lang.loading='now loading..']\n     * @param [config.lang.multipleLabel='\"{{label}}\"외 {{length}}건']\n     * @param [config.columnKeys] - 내부에서 사용 JSON key 정의\n     * @param [config.columnKeys.optionValue='value']\n     * @param [config.columnKeys.optionText='text']\n     * @param [config.columnKeys.optionSelected='selected']\n     */\n    this.config = {\n      theme: 'default',\n      animateTime: 100,\n      height: 34,\n      lang: {\n        noSelected: '',\n        noOptions: 'no options',\n        loading: 'now loading..',\n        multipleLabel: '\"{{label}}\"외 {{length}}건'\n      },\n      columnKeys: {\n        optionValue: 'value',\n        optionText: 'text',\n        optionSelected: 'selected'\n      }\n    };\n    jQuery.extend(true, this.config, config);\n\n    // 멤버 변수 초기화\n    /**\n     * bind를 통해 연결된 select가 저장되는 변수\n     * @member {Array}\n     */\n    this.queue = [];\n    /**\n     * @member {Object}\n     */\n    this.activeSelectOptionGroup = null;\n    /**\n     * @member {Number}\n     */\n    this.activeSelectQueueIndex = -1;\n    /**\n     * @member {Object}\n     */\n    this.openTimer = null;\n    /**\n     * @member {Object}\n     */\n    this.closeTimer = null;\n    /**\n     * @member {Function}\n     */\n    this.waitOptionsCallback = null;\n    /**\n     * @member {Object}\n     */\n    this.keyUpTimer = null;\n    /**\n     * @member {Object}\n     */\n    this.xvar = {};\n\n    this.init();\n  }\n\n  /**\n   * @method\n   * @param config\n   */\n  init() {\n    this.onStateChanged = this.config.onStateChanged;\n    delete this.config.onStateChanged;\n    this.onChange = this.config.onChange;\n    delete this.config.onChange;\n\n    // init 호출 여부\n    this.initOnce();\n  }\n\n  /**\n   * @method\n   */\n  initOnce() {\n    if (this.initialized) return this;\n    this.initialized = true;\n\n    // throttledResize\n    $window.on(\"resize.ax6select-display-\" + this.instanceId, U.throttle(function (e) {\n      alignSelectDisplay.call(this, e || window.event);\n      alignSelectOptionGroup.call(this);\n    }, 100).bind(this));\n  }\n\n  /**\n   * @method\n   * @param item\n   * @return {AX6UISelect}\n   */\n  bind(item) {\n    let queIdx;\n    item = jQuery.extend(true, {}, this.config, item);\n\n    if (!item.target) {\n      console.log(info.getError(\"ax6select\", \"401\", \"bind\"));\n      return this;\n    }\n    item.$target = jQuery(item.target);\n\n    if (!item.id) item.id = item.$target.data(\"data-ax6ui-select-id\");\n    if (!item.id) {\n      item.id = 'ax6select-' + AX6UICore.getInstanceId();\n      item.$target.data(\"data-ax6ui-select-id\", item.id);\n    }\n    item.name = item.$target.attr(\"data-ax6ui-select\");\n\n    if (item.options) {\n      item.options = JSON.parse(JSON.stringify(item.options));\n    }\n\n    // target attribute data\n    (function (data) {\n      if (U.isObject(data) && !data.error) {\n        item = jQuery.extend(true, item, data);\n      }\n    })(U.parseJson(item.$target.attr(\"data-ax6ui-select-config\"), true));\n\n    queIdx = U.search(this.queue, function () {\n      return this.id == item.id;\n    });\n\n    if (queIdx === -1) {\n      this.queue.push(item);\n      bindSelectTarget.call(this, this.queue.length - 1);\n    }\n    else {\n      this.queue[queIdx].selected = [];\n      this.queue[queIdx].options = item.options;\n      this.queue[queIdx] = jQuery.extend(true, {}, this.queue[queIdx], item);\n      bindSelectTarget.call(this, queIdx);\n    }\n\n    queIdx = null;\n    return this;\n  };\n\n  /**\n   * @method\n   * @param boundID\n   * @param tryCount\n   * @return {AX6UISelect}\n   */\n  open(boundID, tryCount) {\n    const onExpand = function (item) {\n      item.onExpand.call({\n        self: this,\n        item: item\n      }, O => {\n        if (this.waitOptionsCallback) {\n          let data = {};\n          let item = this.queue[this.activeSelectQueueIndex];\n\n          /// 현재 selected 검증후 처리\n          (function (item, O) {\n            let optionsMap = {};\n            O.options.forEach((_O, _OIndex) => {\n              _O[\"@index\"] = _OIndex;\n              optionsMap[_O[item.columnKeys.optionValue]] = _O;\n            });\n            if (U.isArray(item.selected)) {\n              item.selected.forEach((_O) => {\n                if (optionsMap[_O[item.columnKeys.optionValue]]) {\n                  O.options[optionsMap[_O[item.columnKeys.optionValue]][\"@index\"]][item.columnKeys.optionSelected] = true;\n                }\n              });\n            }\n          })(item, O);\n\n\n          item.$displayLabel\n            .html(getLabel.call(this, this.activeSelectQueueIndex));\n          item.options = syncSelectOptions.call(this, this.activeSelectQueueIndex, O.options);\n\n          alignSelectDisplay.call(this);\n\n          /// 템플릿에 전달할 오브젝트 선언\n          data.id = item.id;\n          data.theme = item.theme;\n          data.size = \"ax6select-option-group-\" + item.size;\n          data.multiple = item.multiple;\n          data.lang = item.lang;\n          data.options = item.options;\n          this.activeSelectOptionGroup.find('[data-els=\"content\"]').html(mustache.render(optionsTmpl.call(this, item.columnKeys), data));\n        }\n      });\n    };\n    this.waitOptionsCallback = null;\n\n    /**\n     * open select from the outside\n     */\n    let queIdx = (U.isNumber(boundID)) ? boundID : getQueIdx.call(this, boundID),\n      item = this.queue[queIdx],\n      data = {}, focusTop, selectedOptionEl;\n\n    if (item.$display.attr(\"disabled\")) return this;\n\n    if (this.openTimer) clearTimeout(this.openTimer);\n    if (this.activeSelectOptionGroup) {\n      if (this.activeSelectQueueIndex == queIdx) {\n        return this;\n      }\n\n      if (tryCount > 2) return this;\n      this.close();\n      this.openTimer = setTimeout((function () {\n        this.open(queIdx, (tryCount || 0) + 1);\n      }).bind(this), this.config.animateTime);\n\n      return this;\n    }\n\n    item.optionFocusIndex = -1; // optionGroup이 열리면 포커스 인덱스 초기화 -1로\n    if (item.selected && item.selected.length > 0) {\n      item.optionSelectedIndex = item.selected[0][\"@findex\"];\n    }\n\n    /// 템플릿에 전달할 오브젝트 선언\n    data.id = item.id;\n    data.theme = item.theme;\n    data.size = \"ax6select-option-group-\" + item.size;\n    data.multiple = item.multiple;\n\n    data.lang = item.lang;\n    item.$display.attr(\"data-select-option-group-opened\", \"true\");\n    //console.log(data.lang);\n\n    if (item.onExpand) {\n      // onExpand 인 경우 UI 대기모드 추가\n      data.waitOptions = true;\n    }\n\n    data.options = item.options;\n    this.activeSelectOptionGroup = jQuery(mustache.render(optionGroupTmpl.call(this), data));\n    this.activeSelectOptionGroup.find('[data-els=\"content\"]').html(mustache.render(optionsTmpl.call(this, item.columnKeys), data));\n    this.activeSelectQueueIndex = queIdx;\n\n    alignSelectOptionGroup.call(this, \"append\"); // alignSelectOptionGroup 에서 body append\n\n    /// 사용자 입력으로 옵션을 검색하기 위한 시나리오\n    // 옵션그룹이 활성화 되면 사용자 입력을 받기위한 input 값 초기화 및 포커스 다른 select가 닫히면서 display focus 이벤트와 충돌하는 문제가 있으므로\n    // 1밀리세컨 지연후 포커스 처리. input에 포커스가 되므로 input value로 options를 검색 할 수 있게 됩니다.\n    item.$displayInput.val('');\n\n    setTimeout(() => {\n\n      if (item.selected && item.selected.length > 0) {\n        selectedOptionEl = this.activeSelectOptionGroup.find('[data-option-index=\"' + item.selected[0][\"@index\"] + '\"]');\n        if (selectedOptionEl.get(0)) {\n          focusTop = selectedOptionEl.position().top - this.activeSelectOptionGroup.height() / 3;\n          this.activeSelectOptionGroup.find('[data-els=\"content\"]').scrollTop(focusTop);\n        }\n      }\n\n      item.$displayInput.trigger(\"focus\");\n\n      jQuery(window).on(\"keyup.ax6select-\" + this.instanceId, (function (e) {\n        e = e || window.event;\n        onBodyKeyup.call(this, e);\n        U.stopEvent(e);\n      }).bind(this));\n\n      jQuery(window).on(\"click.ax6select-\" + this.instanceId, (function (e) {\n        e = e || window.event;\n        onBodyClick.call(this, e);\n        U.stopEvent(e);\n      }).bind(this));\n\n    }, this.config.animateTime);\n\n    onStateChanged.call(this, item, {\n      self: this,\n      state: \"open\",\n      item: item\n    });\n\n    // waitOption timer\n    if (item.onExpand) {\n      this.waitOptionsCallback = true;\n      onExpand.call(this, item);\n    }\n\n    data = null;\n    focusTop = null;\n    selectedOptionEl = null;\n    return this;\n  }\n\n  /**\n   * @method\n   * @param _item\n   * @return {AX6UISelect}\n   */\n  update(_item) {\n    this.bind(_item);\n    return this;\n  };\n\n  /**\n   * @method\n   * @param boundID\n   * @param options\n   * @return {AX6UISelect}\n   */\n  setOptions(boundID, options) {\n    let queIdx = getQueIdx.call(this, boundID);\n    this.queue[queIdx].selected = [];\n    this.queue[queIdx].options = options;\n    bindSelectTarget.call(this, queIdx);\n    return this;\n  }\n\n  /**\n   * @method\n   * @param boundID\n   * @param value\n   * @param selected\n   * @param internal\n   * @return {*}\n   */\n  val(boundID, value, selected, internal) {\n    const getSelected = function (_item, o, selected) {\n        if (typeof selected === \"undefined\") {\n          return (_item.multiple) ? !o : true;\n        } else {\n          return selected;\n        }\n      },\n      clearSelected = function (queIdx) {\n        this.queue[queIdx].options.forEach(n => {\n          if (n.optgroup) {\n            n.options.forEach(nn => {\n              nn.selected = false;\n            });\n          }\n          else {\n            n.selected = false;\n          }\n        });\n      },\n      processor = {\n        'index': function (queIdx, value, selected) {\n          // 클래스 내부에서 호출된 형태, 그런 이유로 옵션그룹에 대한 상태를 변경 하고 있다.\n          let item = this.queue[queIdx];\n\n          if (U.isString(value.index.gindex)) {\n            item.options[value.index.gindex].options[value.index.index][item.columnKeys.optionSelected] = getSelected(item, item.options[value.index.gindex].options[value.index.index][item.columnKeys.optionSelected], selected);\n            this.activeSelectOptionGroup\n              .find('[data-option-group-index=\"' + value.index.gindex + '\"][data-option-index=\"' + value.index.index + '\"]')\n              .attr(\"data-option-selected\", item.options[value.index.gindex].options[value.index.index][item.columnKeys.optionSelected].toString());\n          }\n          else {\n            item.options[value.index.index][item.columnKeys.optionSelected] = getSelected(item, item.options[value.index.index][item.columnKeys.optionSelected], selected);\n            this.activeSelectOptionGroup\n              .find('[data-option-index=\"' + value.index.index + '\"]')\n              .attr(\"data-option-selected\", item.options[value.index.index][item.columnKeys.optionSelected].toString());\n\n          }\n\n          syncSelectOptions.call(this, queIdx, item.options);\n          syncLabel.call(this, queIdx);\n          alignSelectOptionGroup.call(this);\n        },\n        'arr': function (queIdx, values, selected) {\n          values.forEach(value => {\n            if (U.isString(value) || U.isNumber(value)) {\n              processor.value.call(this, queIdx, value, selected);\n            }\n            else {\n              for (let key in processor) {\n                if (value[key]) {\n                  processor[key].call(this, queIdx, value, selected);\n                  break;\n                }\n              }\n            }\n          });\n        },\n        'value': function (queIdx, value, selected) {\n          let item = this.queue[queIdx],\n            optionIndex = U.search(item.options, function () {\n              return this[item.columnKeys.optionValue] == value;\n            });\n          if (optionIndex > -1) {\n            item.options[optionIndex][item.columnKeys.optionSelected] = getSelected(item, item.options[optionIndex][item.columnKeys.optionSelected], selected);\n          }\n          else {\n            console.log(info.getError(\"ax6select\", \"501\", \"val\"));\n            return;\n          }\n\n          syncSelectOptions.call(this, queIdx, item.options);\n          syncLabel.call(this, queIdx);\n        },\n        'text': function (queIdx, value, selected) {\n          let item = this.queue[queIdx],\n            optionIndex = U.search(item.options, function () {\n              return this[item.columnKeys.optionText] == value;\n            });\n          if (optionIndex > -1) {\n            item.options[optionIndex][item.columnKeys.optionSelected] = getSelected(item, item.options[optionIndex][item.columnKeys.optionSelected], selected);\n          }\n          else {\n            console.log(info.getError(\"ax6select\", \"501\", \"val\"));\n            return;\n          }\n\n          syncSelectOptions.call(this, queIdx, item.options);\n          syncLabel.call(this, queIdx);\n        },\n        'clear': function (queIdx) {\n          clearSelected.call(this, queIdx);\n          syncSelectOptions.call(this, queIdx, this.queue[queIdx].options);\n          syncLabel.call(this, queIdx);\n\n          if (this.activeSelectOptionGroup) {\n            this.activeSelectOptionGroup\n              .find('[data-option-index]')\n              .attr(\"data-option-selected\", \"false\");\n          }\n        }\n      };\n\n    let queIdx = (U.isNumber(boundID)) ? boundID : getQueIdx.call(this, boundID);\n    if (!this.queue[queIdx]) {\n      return this;\n    }\n    if (typeof value !== \"undefined\" && !this.queue[queIdx].multiple) {\n      clearSelected.call(this, queIdx);\n    }\n\n    if (typeof value == \"undefined\") {\n      return this.queue[queIdx].selected;\n    }\n    else if (U.isArray(value)) {\n      processor.arr.call(this, queIdx, value, selected);\n    }\n    else if (U.isString(value) || U.isNumber(value)) {\n      processor.value.call(this, queIdx, value, selected);\n    }\n    else {\n      if (value === null) {\n        processor.clear.call(this, queIdx);\n      }\n      else {\n        for (var key in processor) {\n          if (value[key]) {\n            processor[key].call(this, queIdx, value, selected);\n            break;\n          }\n        }\n      }\n    }\n\n    if (typeof value !== \"undefined\") {\n      onStateChanged.call(this, this.queue[queIdx], {\n        self: this,\n        item: this.queue[queIdx],\n        state: (internal) ? \"changeValue\" : \"setValue\",\n        value: this.queue[queIdx].selected,\n        internal: internal\n      });\n    }\n\n    boundID = null;\n    return this;\n  }\n\n  /**\n   * @method\n   * @param item\n   * @return {AX6UISelect}\n   */\n  close(item) {\n    if (this.closeTimer) clearTimeout(this.closeTimer);\n    if (!this.activeSelectOptionGroup) return this;\n\n    item = this.queue[this.activeSelectQueueIndex];\n    item.optionFocusIndex = -1;\n\n    item.$displayInput.val('').trigger(\"blur\");\n    item.$display.removeAttr(\"data-select-option-group-opened\").trigger(\"focus\");\n\n    this.activeSelectOptionGroup.addClass(\"destroy\");\n\n    jQuery(window)\n      .off(\"resize.ax6select-\" + this.instanceId)\n      .off(\"click.ax6select-\" + this.instanceId)\n      .off(\"keyup.ax6select-\" + this.instanceId);\n\n    this.closeTimer = setTimeout(() => {\n      if (this.activeSelectOptionGroup) this.activeSelectOptionGroup.remove();\n      this.activeSelectOptionGroup = null;\n      this.activeSelectQueueIndex = -1;\n\n      let that = {\n        self: this,\n        item: item,\n        value: item.selected,\n        state: \"close\"\n      };\n\n      onStateChanged.call(this, item, that);\n\n      // waitOption timer\n      if (item.onClose) {\n        item.onClose.call(that);\n      }\n    }, this.config.animateTime);\n    this.waitOptionsCallback = null;\n    return this;\n  };\n\n  /**\n   * @method\n   * @param boundID\n   * @return {AX6UISelect}\n   */\n  enable(boundID) {\n    let queIdx = getQueIdx.call(this, boundID);\n    this.queue[queIdx].$display.removeAttr(\"disabled\");\n    this.queue[queIdx].$select.removeAttr(\"disabled\");\n\n    onStateChanged.call(this, this.queue[queIdx], {\n      self: this,\n      state: \"enable\"\n    });\n\n    return this;\n  };\n\n  /**\n   * @method\n   * @param boundID\n   * @return {AX6UISelect}\n   */\n  disable(boundID) {\n    let queIdx = getQueIdx.call(this, boundID);\n    this.queue[queIdx].$display.attr(\"disabled\", \"disabled\");\n    this.queue[queIdx].$select.attr(\"disabled\", \"disabled\");\n\n    onStateChanged.call(this, this.queue[queIdx], {\n      self: this,\n      state: \"disable\"\n    });\n\n    return this;\n  };\n\n}\n\nexport default AX6UISelect;"]}