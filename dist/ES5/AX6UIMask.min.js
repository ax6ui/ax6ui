"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),_jqmin=require("jqmin"),_jqmin2=_interopRequireDefault(_jqmin),_AX6UICore2=require("./AX6UICore.js"),_AX6UICore3=_interopRequireDefault(_AX6UICore2),_AX6Mustache=require("./AX6Mustache.js"),_AX6Mustache2=_interopRequireDefault(_AX6Mustache),onStateChanged=function(t,e){return t&&t.onStateChanged?t.onStateChanged.call(e,e):this.onStateChanged&&this.onStateChanged.call(e,e),t=null,e=null,!0},getBodyTmpl=function(t,e){return _AX6Mustache2.default.render(function(t){return'\n            <div class="ax-mask {{theme}}" id="{{maskId}}">\n                <div class="ax-mask-bg"></div>\n                <div class="ax-mask-content">\n                    <div class="ax-mask-body">\n                    {{{body}}}\n                    </div>\n                </div>\n            </div>\n        '}.call(this,e),t)},setBody=function(t){this.maskContent=t},AX6UIMask=function(t){function e(t){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return n.config={theme:"",target:(0,_jqmin2.default)(document.body).get(0),animateTime:250},_jqmin2.default.extend(!0,n.config,t),n.maskContent="",n.status="off",n.activeConfig={},void 0!==t&&n.init(),n}return _inherits(e,_AX6UICore3.default),_createClass(e,[{key:"init",value:function(){this.onStateChanged=this.config.onStateChanged,delete this.config.onStateChanged,this.onClick=this.config.onClick,delete this.config.onClick,setBody.call(this,this.config.content||""),this.initOnce()}},{key:"initOnce",value:function(){if(this.initialized)return this;this.initialized=!0}},{key:"open",value:function(t){var e=this;"on"===this.status&&this.close(),setBody.call(this,t?t.content||"":"");var n=_jqmin2.default.extend(!0,this.config,t),i=n.target,s=(0,_jqmin2.default)(i),a="ax-mask-"+this.instanceId,o=void 0,l={},r={},u=n.templateName,c=getBodyTmpl({theme:n.theme,maskId:a,body:this.maskContent,templateName:u}).trim();return(0,_jqmin2.default)(document.body).append(c),i&&i!==(0,_jqmin2.default)(document.body).get(0)&&(l={position:n.position||"absolute",left:s.offset().left,top:s.offset().top,width:s.outerWidth(),height:s.outerHeight()},s.addClass("ax-masking"),(0,_jqmin2.default)(window).on("resize.ax5mask-"+this.instanceId,function(t){e.align()})),void 0!==n.zIndex&&(l["z-index"]=n.zIndex),this.$mask=o=(0,_jqmin2.default)("#"+a),this.$target=s,this.status="on",o.css(l),this.onClick&&o.on("click",function(t){r={self:e,state:"open",type:"click"},e.onClick.call(r,r)}),onStateChanged.call(this,null,{self:this,state:"open"}),this.activeConfig=n,t=null,n=null,i=null,s=null,a=null,o=null,l=null,r=null,u=null,c=null,this}},{key:"close",value:function(t){if(this.$mask){var e=function(){this.status="off",this.$mask.remove(),this.$target.removeClass("ax-masking"),onStateChanged.call(this,null,{self:this,state:"close"}),(0,_jqmin2.default)(window).off("resize.ax5mask-"+this.instanceId)};t?setTimeout(function(){e.call(this)}.bind(this),t):e.call(this)}return this}},{key:"fadeOut",value:function(){if(this.$mask){var t=function(){this.status="off",this.$mask.remove(),this.$target.removeClass("ax-masking"),onStateChanged.call(this,null,{self:this,state:"close"}),(0,_jqmin2.default)(window).off("resize.ax5mask-"+this.instanceId)};this.$mask.addClass("fade-out"),setTimeout(function(){t.call(this)}.bind(this),this.activeConfig.animateTime)}return this}},{key:"align",value:function(){if(this.$mask&&this.activeConfig&&this.activeConfig.target&&this.activeConfig.target!==(0,_jqmin2.default)(document.body).get(0))try{var t={position:this.activeConfig.position||"absolute",left:this.$target.offset().left,top:this.$target.offset().top,width:this.$target.outerWidth(),height:this.$target.outerHeight()};this.$mask.css(t)}catch(t){}return this}}]),e}();exports.default=AX6UIMask;
//# sourceMappingURL=AX6UIMask.js.map
