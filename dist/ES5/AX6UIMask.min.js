"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(exports,"__esModule",{value:!0});var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),_jqmin=require("jqmin"),_jqmin2=_interopRequireDefault(_jqmin),_AX6UICore2=require("./AX6UICore.js"),_AX6UICore3=_interopRequireDefault(_AX6UICore2),_AX6Util=require("./AX6Util"),_AX6Util2=_interopRequireDefault(_AX6Util),_AX6Mustache=require("./AX6Mustache.js"),_AX6Mustache2=_interopRequireDefault(_AX6Mustache),getBodyTmpl=function(t,e){return _AX6Mustache2.default.render(function(t){return'\n            <div data-ax6ui-mask="" class="{{theme}}" id="{{maskId}}">\n                <div class="ax-mask-bg"></div>\n                <div class="ax-mask-content">\n                    <div class="ax-mask-body">\n                    {{{body}}}\n                    </div>\n                </div>\n            </div>\n        '}.call(this,e),t)},onStateChanged=function(t,e){return t&&t.onStateChanged?t.onStateChanged.call(e,e):this.onStateChanged&&this.onStateChanged.call(e,e),t=null,e=null,!0},setBody=function(t){this.maskContent=t},AX6UIMask=function(t){function e(t){_classCallCheck(this,e);var i=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.config={theme:"",target:(0,_jqmin2.default)(document.body).get(0),animateTime:250},_jqmin2.default.extend(!0,i.config,t),i.maskContent="",i.status="off",i.activeConfig={},void 0!==t&&i.init(),i}return _inherits(e,_AX6UICore3.default),_createClass(e,[{key:"init",value:function(){this.onStateChanged=this.config.onStateChanged,delete this.config.onStateChanged,this.onClick=this.config.onClick,delete this.config.onClick,setBody.call(this,this.config.content||""),this.initOnce()}},{key:"initOnce",value:function(){if(this.initialized)return this;this.initialized=!0}},{key:"open",value:function(t){var e=this;"on"===this.status&&this.close(),setBody.call(this,t?t.content||"":"");var i=_jqmin2.default.extend(!0,this.config,t),n=i.target,a=(0,_jqmin2.default)(n),s="ax-mask-"+this.instanceId,o=void 0,l={},r={},u=i.templateName,c=getBodyTmpl({theme:i.theme,maskId:s,body:this.maskContent,templateName:u}).trim();return(0,_jqmin2.default)(document.body).append(c),n&&n!==(0,_jqmin2.default)(document.body).get(0)&&(l={position:i.position||"absolute",left:a.offset().left,top:a.offset().top,width:a.outerWidth(),height:a.outerHeight()},a.addClass("ax-masking"),(0,_jqmin2.default)(window).on("resize.ax5mask-"+this.instanceId,_AX6Util2.default.throttle(function(t){this.align()},100).bind(this))),void 0!==i.zIndex&&(l["z-index"]=i.zIndex),this.$mask=o=(0,_jqmin2.default)("#"+s),this.$target=a,this.status="on",o.css(l),this.onClick&&o.on("click",function(t){r={self:e,state:"open",type:"click"},e.onClick.call(r,r)}),onStateChanged.call(this,null,{self:this,state:"open"}),this.activeConfig=i,t=null,i=null,n=null,a=null,s=null,o=null,l=null,r=null,u=null,c=null,this}},{key:"close",value:function(t){if(this.$mask){var e=function(){this.status="off",this.$mask.remove(),this.$target.removeClass("ax-masking"),onStateChanged.call(this,null,{self:this,state:"close"}),(0,_jqmin2.default)(window).off("resize.ax5mask-"+this.instanceId)};t?setTimeout(function(){e.call(this)}.bind(this),t):e.call(this)}return this}},{key:"fadeOut",value:function(){if(this.$mask){var t=function(){this.status="off",this.$mask.remove(),this.$target.removeClass("ax-masking"),onStateChanged.call(this,null,{self:this,state:"close"}),(0,_jqmin2.default)(window).off("resize.ax5mask-"+this.instanceId)};this.$mask.addClass("fade-out"),setTimeout(function(){t.call(this)}.bind(this),this.activeConfig.animateTime)}return this}},{key:"align",value:function(){if(this.$mask&&this.activeConfig&&this.activeConfig.target&&this.activeConfig.target!==(0,_jqmin2.default)(document.body).get(0))try{var t={position:this.activeConfig.position||"absolute",left:this.$target.offset().left,top:this.$target.offset().top,width:this.$target.outerWidth(),height:this.$target.outerHeight()};this.$mask.css(t)}catch(t){}return this}}]),e}();exports.default=AX6UIMask;
//# sourceMappingURL=AX6UIMask.js.map
